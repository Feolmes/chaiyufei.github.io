(self.webpackChunk_fenbi_ada_video_interactive=self.webpackChunk_fenbi_ada_video_interactive||[]).push([[826],{63017:function(e,t,n){"use strict";var i=n(20862),a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(50008)),s=n(95208),r=i(n(11831)),u=n(37857),c=a(n(29112)),l={init:function(){var e=this;(0,s.isYBCApplication)()&&s.application.getAppConfig().then((function(t){e.version=t.appVersion,console.log(e.version)}))},isYBCApp:function(){return(0,s.isYBCApplication)()},isSafeAppVersion:function(){return!(0,u.checkNotAllowVersion)(this.version)},isYMMApp:function(){return r.isInnerApp},isMute:function(e){(0,s.isYBCApplication)()&&s.system.getMuteState().then((function(t){console.log("app-system","mutedInfo",t),e(t.muted)})).catch((function(e){console.error(e)}))},getAppInstance:function(){return s.application},getSafeArea:function(e){(0,s.isYBCApplication)()?s.system.getSystemInfo().then((function(t){var n=t.screen,i=n.safeArea,a=n.screenScale;i.left>0&&(i.left=i.left/a),i.top>0&&(i.top=i.top/a),e(i)})):r.isInnerApp&&e({})},getLocalResource:function(e){return(0,s.isYBCApplication)()&&!(0,u.checkNotAllowVersion)(this.version)?s.store.getResource(e):Promise.reject()},emitComplete:function(){c.default.info("emitComplete"),(0,s.isYBCApplication)()?s.lifecycle.emitComplete():r.isInnerApp&&r.default.execWithTimeout("questionInited",-1)},isAIApp:function(){return s.isYBCAIApplication&&(0,s.isYBCAIApplication)()},emitError:function(){c.default.info("emitError"),(0,s.isYBCApplication)()?s.lifecycle.emitError():r.isInnerApp&&r.default.execWithTimeout("questionInitedFailed",-1)},emitExit:function(){c.default.info("emitExit"),(0,s.isYBCApplication)()?s.lifecycle.emitExit():r.isInnerApp&&r.default.execWithTimeout("closeWebView",-1)},emitReady:function(){c.default.info("emitReady"),(0,s.isYBCApplication)()?s.lifecycle.emitReady():r.isInnerApp&&r.default.execWithTimeout("questionInited",-1)},emitExitRoom:function(e){c.default.info("emitExitRoom"),(0,s.isYBCApplication)()?s.lifecycle.emitExitRoom(e):r.isInnerApp&&r.default.execWithTimeout("questionComplete",{status:"success"})},sendBehavior:function(e){if((0,s.isYBCApplication)())try{s.record.sendBehaviorFrog("actInSection",""+e,JSON.stringify({sectionActDetail:{result:3}}))}catch(e){console.error(e)}},sendFrog:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==(0,o.default)(s.frog)&&s.frog){var n=[];Object.keys(t).forEach((function(e){n.push({key:e,value:t[e]})})),s.frog.send(e,n)}},onStart:function(e){c.default.info("onStart"),(0,s.isYBCApplication)()?s.lifecycle.onStart(e):r.isInnerApp&&r.default.addNativeEventListener("questionStart",e),window.onStart=function(){e()}},onResume:function(e){(0,s.isYBCApplication)()||r.isInnerApp&&r.default.addNativeEventListener("questionResume",e)},onPause:function(e){(0,s.isYBCApplication)()||r.isInnerApp&&r.default.addNativeEventListener("questionPause",e)},onBeforeSystemBack:function(e){(0,s.isYBCApplication)()&&s.clientEvent.on("before-system-back",(function(){return e(),Promise.resolve(!0)}))},onExitDialogCancel:function(e){c.default.info("onExitDialogCancel"),(0,s.isYBCApplication)()?s.lifecycle.onExitDialogCancel(e):r.isInnerApp},onBeforeExit:function(e,t){t||(t=5e3),(0,s.isYBCApplication)()&&s.lifecycle.onBeforeExit(e,t)},sendDebugLog:function(e){(0,s.isYBCApplication)()&&s.log.info("ada-video-interactive",e)},showAppToast:function(e){(0,s.isYBCApplication)()&&(console.log("showAppToast",e),s.toast.info(e))}};l.init();var d=l;t.default=d},89145:function(e,t,n){"use strict";var i=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(87757)),o=i(n(48926)),s=n(37857),r=n(95208),u=i(n(29112)),c={pendingMessage:[],lastCaseState:null,submitCaseState:null,init:function(e,t,n){var i=this;u.default.info("GameRuntimeLoader init",e),e?(this.gamePath=e,this._path=this.gamePath,/\//.test(this.gamePath)||(this._path="./gameAssets/"+this.gamePath),this._createScript(this._path+"/javascript/index.js",(function(){i._initGame()}),n),this.readyCallback=t,this.isReady=!1,this.hasCallReady=!1,this.errorCallback=n,this.startListenGameReady()):n("error gamePath")},getRequestByClient:function(e,t){return u.default.info("GameRuntimeLoader getRequestByClient",e,JSON.stringify(t)),r.network.requestByClient.get(e,t)},postRequestByClient:function(e,t,n){return u.default.info("GameRuntimeLoader postRequestByClient",e,JSON.stringify(t),JSON.stringify(n)),r.network.requestByClient.post(e,t,n)},loadRemoteCaseState:function(){var e=this;return(0,o.default)(a.default.mark((function t(){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u.default.info("GameRuntimeLoader loadRemoteCaseState",e.lastCaseState),t.abrupt("return",e.lastCaseState||null);case 2:case"end":return t.stop()}}),t)})))()},saveRemoteCaseState:function(e){var t=this;return(0,o.default)(a.default.mark((function n(){return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:u.default.info("GameRuntimeLoader saveRemoteCaseState",e),"string"!=typeof e&&(e=JSON.stringify(e)),t.submitCaseState=e;case 3:case"end":return n.stop()}}),n)})))()},_initGame:function(){var e=this,t={type:Phaser.Auto,width:1920,height:1080,scale:{mode:Phaser.Scale.FIT,zoom:(0,s.isIPad)()&&(0,s.isIOS15)()?.5:void 0},dom:{createContainer:!0},transparent:!0,parent:"game-container"},n=new Phaser.Game(t);n.events.once("caseInitComplete",(function(){e.loadCompleteHandler("caseInitComplete")})),n.loadRemoteCaseState=this.loadRemoteCaseState.bind(this),n.saveRemoteCaseState=this.saveRemoteCaseState.bind(this),this.game=n,window.game=n,addScene(n,this._path,this.getRequestByClient,this.postRequestByClient)},_createScript:function(e,t,n){var i=document.createElement("script");i.src=e,document.body.appendChild(i),i.onload=function(){u.default.info("GameRuntimeLoader _createScript onload",e),t&&t()},i.onerror=function(e){console.error(e),u.default.info("GameRuntimeLoader _createScript error ",(0,s.formatErrorInfo)(e)),Sentry.captureException(e),n&&n(e)}},startListenGameReady:function(){var e,t,n,i=this,a=0,o=function(){var e,t,n;if((null===(e=i.game)||void 0===e||null===(t=e.scene)||void 0===t||null===(n=t.scenes)||void 0===n?void 0:n.length)>0){clearInterval(a),u.default.info("GameRuntimeLoader startListenGameReady listener");try{i.game.scene.scenes[0].load.on("complete",(function(){i.loadCompleteHandler("onSceneComplete")})),i.game.scene.scenes[0].load.on("loaderror",(function(e){var t=(0,s.formatErrorInfo)(e);u.default.info("GameRuntimeLoader startListenGameReady loaderror ",t),Sentry.captureException(e),e&&i.errorCallback(e)}))}catch(e){u.default.info("GameRuntimeLoader startListenGameReady error ",e),i.errorCallback(e)}setTimeout((function(){i.hasCallReady||(u.default.info("GameRuntimeLoader startListenGameReady timeout invoke"),i.readyCallback(i.game))}),2e3)}};o(),null!==(e=this.game)&&void 0!==e&&null!==(t=e.scene)&&void 0!==t&&null!==(n=t.scenes)&&void 0!==n&&n.length||(a=setInterval(o,10))},loadCompleteHandler:function(e){u.default.info("GameRuntimeLoader loadCompleteHandler type=".concat(e," hasCallReady=").concat(this.hasCallReady)),this.hasCallReady||(this.hasCallReady=!0,this.readyCallback(this.game),this.isReady=!0,this.clearPendingMessage())},dispatchGameMessage:function(e){this.isReady?(u.default.info("GameRuntimeLoader emitMessage",e),this.game.events.emit(e)):(u.default.info("GameRuntimeLoader pendingMessage",e),this.pendingMessage.push(e))},clearPendingMessage:function(){var e=this;u.default.info("GameRuntimeLoader clearPendingMessage",this.pendingMessage.join(".")),this.pendingMessage.forEach((function(t){e.dispatchGameMessage(t)})),this.pendingMessage=[]},stopGameRunning:function(){this.dispatchGameMessage("interaction-pause")},resumeGameRunning:function(){this.dispatchGameMessage("interaction-resume")},startGameRunning:function(){var e=this;u.default.info("GameRuntimeLoader before startGameRunning"),this.dispatchGameMessage("questionStart"),setTimeout((function(){e.hasCallReady||(u.default.info("GameRuntimeLoader startGameRunning timeout invoke"),e.hasCallReady=!0,e.isReady=!0,e.clearPendingMessage())}),1e4)}};t.default=c},37857:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];clearTimeout(t),t=setTimeout((function(){e.apply(n,o)}),i)}},t.timeStr2Seconds=function(e){var t=0;try{e&&e.split(":").map((function(e,n){t+=2!=n?parseInt(e)*Math.pow(60,1-n):parseInt(e)/100}))}catch(e){console.log(e)}return t},t.preloadVideo=function(e,t,n){fetch(e).then((function(e){e.blob().then((function(e){t(URL.createObjectURL(e))}))})).catch((function(e){console.error(e),n(e)}))},t.checkQQBrowser=function(){return-1!==navigator.userAgent.indexOf("MQQ")},t.isMobile=function(){return/iPhone|iPad|Android/i.test(navigator.userAgent)},t.isIPad=function(){return/iPad/i.test(navigator.userAgent)},t.isIOS15=function(){return"function"==typeof createImageBitmap&&/iPhone|iPad/i.test(navigator.userAgent)},t.checkNotAllowVersion=function(e){return-1!=["3.1.0","3.2.0","3.0.0","3.3.0","3.2.1"].indexOf(e)},t.formatErrorInfo=function(e){var t,n="",i={message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,stack:e.error&&e.error.stack,isTrusted:e.isTrusted};n+="errorInfo="+JSON.stringify(i),e.toString instanceof Function&&(n+="toString="+e.toString()),e.valueOf instanceof Function&&(n+="valueOf="+e.valueOf());var a=null===(t=e.target)||void 0===t?void 0:t.localName;"link"===a?n+="link="+e.target.href:"script"===a&&(n+="script="+e.target.src);var o=e.src;return o&&(n+="src="+o),n}},11831:function(e,t,n){"use strict";var i=n(20862),a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.hasPlayVideoApi=function(){return new Promise((function(e){e(r.default.checkApi("startPlayVideo")&&(!r.isAndroid||r.default.checkApi("getDeviceInfo")))}))},t.playNativeVideo=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(n,i){r.default.execWithTimeout("startPlayVideo",-1,{url:e,fromLast:t},(function(e,t){t&&n(!0),e&&i(e)}))}))},Object.defineProperty(t,"isAndroid",{enumerable:!0,get:function(){return r.isAndroid}}),Object.defineProperty(t,"isIOS",{enumerable:!0,get:function(){return r.isIOS}}),Object.defineProperty(t,"isInnerApp",{enumerable:!0,get:function(){return r.isInnerApp}}),Object.defineProperty(t,"ajaxPostFile",{enumerable:!0,get:function(){return r.ajaxPostFile}}),Object.defineProperty(t,"ajaxPostJSON",{enumerable:!0,get:function(){return r.ajaxPostJSON}}),t.default=void 0;var o=a(n(34575)),s=a(n(93913)),r=i(n(77520)),u=new(function(){function e(t){(0,o.default)(this,e),this.webview=t}return(0,s.default)(e,[{key:"initMethods",value:function(e){var t=this;e.forEach((function(e){t.initMethod(e)}))}},{key:"initMethod",value:function(e){this[e]=function(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=this.webview[e]).call.apply(t,[this.webview].concat(i))}}}]),e}())(r.default);t.default=u,u.initMethods(["exec","execWithTimeout","addNativeEventListener","removeNativeEventListener","checkApi"])},28509:function(e,t,n){"use strict";n(82526),n(41817),n(72443),n(92401),n(8722),n(32165),n(69007),n(83510),n(41840),n(6982),n(32159),n(96649),n(39341),n(60543),n(92222),n(50545),n(26541),n(43290),n(57327),n(69826),n(34553),n(84944),n(86535),n(89554),n(91038),n(26699),n(82772),n(79753),n(66992),n(69600),n(94986),n(21249),n(26572),n(85827),n(96644),n(65069),n(47042),n(5212),n(2707),n(38706),n(40561),n(33792),n(99244),n(18264),n(76938),n(39575),n(16716),n(3843),n(28733),n(5735),n(96078),n(83710),n(24812),n(4855),n(68309),n(73706),n(51532),n(99752),n(82376),n(73181),n(23484),n(2388),n(88621),n(60403),n(84755),n(25438),n(90332),n(40658),n(40197),n(44914),n(52420),n(60160),n(60970),n(10408),n(73689),n(9653),n(93299),n(35192),n(33161),n(44048),n(78285),n(44363),n(55994),n(61874),n(9494),n(56977),n(55147),n(19601),n(78011),n(59595),n(33321),n(69070),n(35500),n(69720),n(43371),n(38559),n(38880),n(49337),n(36210),n(30489),n(43304),n(41825),n(98410),n(72200),n(47941),n(94869),n(33952),n(57227),n(60514),n(68304),n(41539),n(26833),n(54678),n(91058),n(88674),n(17727),n(36535),n(12419),n(69596),n(52586),n(74819),n(95683),n(39361),n(51037),n(5898),n(67556),n(14361),n(83593),n(39532),n(24603),n(74916),n(92087),n(39714),n(70189),n(79841),n(27852),n(94953),n(32023),n(78783),n(4723),n(66528),n(83112),n(38992),n(82481),n(15306),n(64765),n(23123),n(23157),n(73210),n(48702),n(55674),n(15218),n(74475),n(57929),n(50915),n(29253),n(42125),n(78830),n(58734),n(29254),n(37268),n(7397),n(60086),n(80623),n(44197),n(76495),n(87145),n(35109),n(65125),n(82472),n(49743),n(8255),n(29135),n(92990),n(18927),n(33105),n(35035),n(74345),n(7174),n(32846),n(98145),n(44731),n(77209),n(96319),n(58867),n(37789),n(33739),n(95206),n(29368),n(14483),n(12056),n(3462),n(30678),n(27462),n(33824),n(55021),n(12974),n(15016),n(4129),n(38478),n(54747),n(33948),n(84633),n(85844),n(32564),n(60285),n(83753),n(41637),n(35666),n(58267),n(27959),n(78294)},28641:function(e,t,n){"use strict";var i=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.default}}),t.FROG_EVENTS=void 0;var a=i(n(99185));t.FROG_EVENTS={EVENT_ENTER_QUESTION:"/event/tutorYbc/QuestionBank/EnterQuestion",CLICK_BACK_BUTTON:"/click/tutorYbc/QuestionBank/QuestionQuitClick",CLICK_EXIT:"/click/tutorYbc/QuestionBank/QuestionQuitSub",CLICK_CANCEL_EXIT:"/click/tutorYbc/QuestionBank/QuestionQuitCancel",CLICK_PASS_QUESTION:"/click/tutorYbc/QuestionBank/QuestionPassClick",CLICK_FINISH:"/event/tutorYbc/QuestionBank/QuestionPassby"}},52948:function(e,t,n){"use strict";var i=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.environment=t.default=void 0;var a=i(n(56189)),o={env:"production",baseUrl:"https://steam.yuanfudao.com"};t.environment=o,a.default.setOptions({baseUrl:o.baseUrl});var s=a.default;t.default=s},75135:function(e,t,n){"use strict";var i=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.reportQuestionAnswerData=function(e){return a.default.post("/ada-event-tracking/api/neo-client/question",{body:e})},t.answerQuestion=function(e){return a.default.post("/ada-steam-mission-gateway/api/user-mission-questions/answer",{body:e})},t.fetchContent=void 0;var a=i(n(52948)),o=a.default.commonQueryParams,s=o.userMissionId,r=o.missionTemplateQuestionId;t.fetchContent=function(){return a.default.get("/".concat("ada-steam-mission-gateway/api/user-mission-questions"),{params:{userMissionId:s,missionTemplateQuestionId:r}})}},15303:function(e,t,n){"use strict";var i=n(20862),a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(67154)),s=a(n(34575)),r=a(n(93913)),u=a(n(81506)),c=a(n(2205)),l=a(n(78585)),d=a(n(29754)),f=i(n(67294)),p=a(n(49872)),h=a(n(63017)),m=i(n(28641)),v=a(n(52948)),y=a(n(29112));t.default=function(e){return function(t){(0,c.default)(g,t);var n,i,a=(n=g,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,d.default)(n);if(i){var a=(0,d.default)(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return(0,l.default)(this,e)});function g(){var e;return(0,s.default)(this,g),e=a.call(this),(0,p.default)((0,u.default)(e),["onNativeEvent","onIframeEvent"]),e.state={matrix:null},window.addEventListener("message",e.onIframeEvent),y.default.info("questionLoaded href"+location.href),e}return(0,r.default)(g,[{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.onIframeEvent)}},{key:"onIframeEvent",value:function(e){"SOURCE_FROM_MATRIX"===(e.data?e.data.type:"")&&this.setState({matrix:{data:e.data.content}})}},{key:"onNativeEvent",value:function(e){var t=e.questionStart,n=e.questionResume,i=e.questionPause;t&&h.default.onStart(t),n&&h.default.onResume(n),i&&h.default.onPause(i)}},{key:"questionInited",value:function(){y.default.info("questionInited"),setTimeout((function(){h.default.emitReady()}),100),h.default.onBeforeExit((function(){return(0,m.default)(m.FROG_EVENTS.CLICK_CANCEL_EXIT),!0}),100),(0,m.default)(m.FROG_EVENTS.EVENT_ENTER_QUESTION)}},{key:"questionComplete",value:function(){v.default.commonQueryParams.sectionId&&h.default.sendBehavior(v.default.commonQueryParams.sectionId),(0,m.default)(m.FROG_EVENTS.CLICK_FINISH),h.default.emitComplete()}},{key:"questionInitedFailed",value:function(){h.default.emitError()}},{key:"questionExit",value:function(){h.default.emitExitRoom(v.default.commonQueryParams.sectionId),(0,m.default)(m.FROG_EVENTS.CLICK_BACK_BUTTON)}},{key:"render",value:function(){return f.default.createElement(e,(0,o.default)({onNativeEvent:this.onNativeEvent,questionInited:this.questionInited,questionComplete:this.questionComplete,questionInitedFailed:this.questionInitedFailed,questionExit:this.questionExit,matrix:this.state.matrix},this.props))}}]),g}(f.Component)}},7643:function(e,t,n){"use strict";var i=n(95318);n(63264),n(28509),n(42191);var a=i(n(67294)),o=i(n(73935)),s=i(n(41464)),r=i(n(41227)),u=document.createElement("div");u.className=r.default.app,document.body.appendChild(u),o.default.render(a.default.createElement(s.default,null),u)},63264:function(e,t,n){n.p="./",e.exports=n.p},41464:function(e,t,n){"use strict";var i=n(20862),a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(87757)),s=a(n(59713)),r=a(n(48926)),u=a(n(34575)),c=a(n(93913)),l=a(n(81506)),d=a(n(2205)),f=a(n(78585)),p=a(n(29754)),h=i(n(67294)),m=i(n(45697)),v=a(n(94184)),y=a(n(49872)),g=n(75135),C=a(n(15303)),w=i(n(28641)),b=n(37857),S=a(n(26434)),I=a(n(89145)),P=a(n(63017)),R=a(n(52948)),E=a(n(98469)),A=a(n(29112)),k=n(11831),T=n(25747);var _=.05,O=function(e){(0,d.default)(a,e);var t,n,i=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,p.default)(t);if(n){var a=(0,p.default)(this).constructor;e=Reflect.construct(i,arguments,a)}else e=i.apply(this,arguments);return(0,f.default)(this,e)});function a(e){var t;return(0,u.default)(this,a),t=i.call(this,e),(0,y.default)((0,l.default)(t),["handleLoaded","handleDoubt","handleQuestionEnd","handleAnswerEnd","handleNext","fetchData","initData","questionStart","questionPause","questionResume","setQuestionPlayer","setAnswerPlayer","backNormalVideo","toggleVideo","updateTime","onVideoPlay","playError","playEnd","playVideo"]),t.gameContainer=document.querySelector("#game-container"),t.state={isPlayQuestion:!1,hasNext:!1,questionScratch:"",answerScratch:"",showBCLineBack:!1,videoUrl:"",remoteVideoUrl:"",caseStartTime:null,caseTimeRange:{start:0,end:0},isPlaying:!1,showToggle:!1,gamePath:"",safetyLeftArea:0,questionContent:null},t.hasShowCase=!1,t.skipDuration=30,t.isGameOver=!1,t.nextTimer=null,t.questionPlayer=null,t.answerPlayer=null,t.videoRef=(0,h.createRef)(),t.videoContainerRef=(0,h.createRef)(),t.incentiveViewRef=(0,h.createRef)(),t.fetchData(),e.onNativeEvent({questionStart:t.questionStart,questionPause:t.questionPause,questionResume:t.questionResume}),t}return(0,c.default)(a,[{key:"componentDidUpdate",value:function(e){!e.matrix&&this.props.matrix&&(this.initData(this.props.matrix.data),this.setState({showMatrixBtn:!0}))}},{key:"componentDidMount",value:function(){var e=this;this.setCanvas(),window.videoPlay=function(){var t=e.state.videoUrl;e.game&&e.game.destroy(!0),e.isEnd||!t?(e.submitAnswer(),e.setState({showToggle:!1,isPlaying:!1})):(e.forceHideCase(),e.playVideo(),e.setState({showToggle:!0,isPlaying:!0}))},this._showToggle=(0,b.debounce)((function(){e.hasShowCase||e.setState({showToggle:!e.state.showToggle})}),300),this.videoContainerRef&&this.videoContainerRef.current.addEventListener("click",this._showToggle),P.default.onBeforeSystemBack((function(){e.videoRef.current&&e.videoRef.current.pause(),e.setState({isPlaying:!1}),e.state.hasShowCase&&I.default.stopGameRunning()})),P.default.onExitDialogCancel((function(){I.default.resumeGameRunning(),e.hasShowCase||(e.playVideo(),e.setState({isPlaying:!0}))})),P.default.getSafeArea((function(t){t&&t.left>0&&e.setState({safetyLeftArea:t.left})})),window.addEventListener("resize",this.setCanvas),document.addEventListener("visibilitychange",(function(){e.game&&(A.default.info("visibilitychange",document.visibilityState),"visible"===document.visibilityState?I.default.resumeGameRunning():I.default.stopGameRunning())})),document.addEventListener("focusout",this.focusoutHandler)}},{key:"focusoutHandler",value:function(){k.isIOS&&window.scrollTo({top:0,left:0,behavior:"smooth"})}},{key:"questionStart",value:function(){A.default.info("questionStart"),P.default.isSafeAppVersion()?(navigator.userAgent.match(/iP(hone|od|ad)/)&&P.default.isMute((function(e){A.default.info("isMute",e),e&&E.default.warning("该设备处于静音状态，请关闭静音哦",1500,!1)})),I.default.startGameRunning(),this.hasShowCase?this.setState({showToggle:!1}):this.playVideo()):E.default.warning("当前 APP 版本过低请升级",1500,!1)}},{key:"questionPause",value:function(){this.questionPlayer&&this.questionPlayer.pause(),this.answerPlayer&&this.answerPlayer.pause()}},{key:"questionResume",value:function(){this.questionPlayer&&this.questionPlayer.resume(),this.answerPlayer&&this.answerPlayer.resume()}},{key:"setQuestionPlayer",value:function(e){this.questionPlayer=e}},{key:"setAnswerPlayer",value:function(e){this.answerPlayer=e}},{key:"fetchData",value:function(){var e=this;(0,g.fetchContent)().then((function(t){e.initData(t)})).catch((function(t){e.props.questionInitedFailed(),A.default.info("fetch api error",t)}))}},{key:"initData",value:function(){var e,t,n,i=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o={};if("string"==typeof a&&(a=JSON.parse(a)),this.reportProviderData=a,I.default.lastCaseState=a.latestAnswer,a.questionContent){this.questionStartTime=(new Date).getTime();var s=a.questionContent;if("string"==typeof s)try{o=s=JSON.parse(s),this.setState({questionContent:o}),console.log("questionContent",o),e=(0,b.timeStr2Seconds)(o.videoCase.caseArr[0].startTime),t=o.videoCase.mainVideo,n=o.videoCase.caseArr[0].fileName.replace(".zip","");var r=o.videoCase.caseArr[0].url,u=r&&r.split("/").pop();u&&(u=u.replace(".zip",""),console.log("localFileName",u),P.default.getLocalResource("").then((function(e){if(console.log("localFilePath",e),e&&(n=e+u+"/"+n,i.setState({gamePath:n})),!n&&!t)throw A.default.info("can not find game path"),new Error("can not find game path");t?i.handleVideo(t):i.trySendReadyEvent()})).catch((function(e){console.error("parse data error"+e),t?i.handleVideo(t):i.props.questionInited(),A.default.error("getLocalResource error",e)})))}catch(e){A.default.error("questionInitedFailed error",e),this.props.questionInitedFailed()}}this.setState({showBCLineBack:!a.stageY,caseStartTime:e,caseTimeRange:{start:e,end:e+_},caseFinished:!1,gamePath:n}),window.userId||Sentry&&Sentry.setTag("userId",a.userId)}},{key:"handleVideo",value:function(e){var t=this,n=!0;navigator.userAgent.match(/iP(hone|od|ad)/)&&parseFloat(String(navigator.userAgent.match(/[0-9]+_[0-9]/)).split("_")[0]+"."+String(navigator.userAgent.match(/[0-9]_[0-9]/)).split("_")[0])<=10&&(n=!1),(0,b.checkQQBrowser)()&&(n=!1),A.default.info("useBlob"+n),n?(0,b.preloadVideo)(e,(function(e){t.setState({videoUrl:e}),t.trySendReadyEvent()}),(function(n){t.setState({videoUrl:e,remoteVideoUrl:e}),t.bindVideoLoadEvent()})):(this.setState({videoUrl:e,remoteVideoUrl:e}),this.bindVideoLoadEvent())}},{key:"setCanvas",value:function(){A.default.info("setCanvas",window.innerHeight,window.innerWidth);var e=window.innerHeight/window.innerWidth,t=document.getElementById("game-container");if(e>9/16){var n=window.innerWidth/16*9;t.style.width="100%",t.style.height=n+"px",t.style["margin-top"]="-"+n/2+"px",t.style.top="50%",t.style.left=0,t.style["margin-left"]=0}else{var i=window.innerHeight/9*16;t.style.width=i+"px",t.style.height="100%",t.style["margin-left"]="-"+i/2+"px",t.style.left="50%",t.style.top=0,t.style["margin-top"]=0}A.default.info("container style",t.style.width,t.style.height)}},{key:"trySendReadyEvent",value:function(e){var t=this.state,n=t.videoUrl,i=t.gamePath,a=t.remoteVideoUrl,o=t.caseStartTime;A.default.info("remoteVideoUrl"+a),A.default.info("videoUrl"+n),A.default.info("gamePath"+i);var s=o>=_;if(A.default.info("isNeedHideCase"+s),s||this.showCase(),this.hasShowCase=!s,a){if(e&&this.game)return s&&this.hideCase(),void this.props.questionInited()}else{if(i&&n)return s&&this.hideCase(),void this.props.questionInited();i&&this.props.questionInited()}!i&&n&&this.props.questionInited()}},{key:"handleLoaded",value:function(){this.props.questionInited()}},{key:"handleDoubt",value:function(){this.isGameOver||(this.setState({isPlayQuestion:!0,showExtraBtn:!1}),(0,w.default)(w.FROG_EVENTS.CLICK_PLAY_QUESTION))}},{key:"handleQuestionEnd",value:function(){var e=this;this.setState({isPlayQuestion:!1,showExtraBtn:!0}),this.nextTimer||(this.nextTimer=setTimeout((function(){e.setState({hasNext:!0})}),1e3*this.skipDuration))}},{key:"submitAnswer",value:function(){var e=this;A.default.info("submitAnswer"),(0,g.answerQuestion)({userQuestionId:this.reportProviderData.id,userQuestionAnswerRoundId:this.reportProviderData.userQuestionAnswerRoundId,status:1,timeElapsed:(new Date).getTime()-this.questionStartTime,answer:I.default.submitCaseState||"",userSectionId:R.default.commonQueryParams.sectionId}).then(function(){var t=(0,r.default)(o.default.mark((function t(n){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return A.default.info("submitAnswer success",n),t.next=3,e.showIncentiveView(n);case 3:e.reportQuestionAnswerData({answerId:n.id});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){A.default.info("submitAnswer fail",t),e.props.questionComplete()}))}},{key:"showIncentiveView",value:function(e){var t=this,n=this.state.questionContent||{},i=n.hasCoin,a=n.incentiveType,o=e.score;return A.default.info("showIncentiveView",i,o),i?new Promise((function(e){var n={container:t.incentiveViewRef.current,onClose:function(){e()}};"block"===a?(n.stars=3,n.type="block"):(n.result=!0,n.type="code"),o&&(n.coin=o),(0,T.BCIncentiveView)(n)})):Promise.resolve()}},{key:"reportQuestionAnswerData",value:function(e){var t=this;if(P.default.isYBCApp())try{var n=R.default.commonQueryParams,i=n.ybcEpisodeId,a=n.ybcLessonId,o=n.sectionId,s=n.missionType,r=n.userMissionId,u=e.answerId,c=Number(i||0),l=this.reportProviderData.userId,d={startTime:this.questionStartTime,endTime:(new Date).getTime(),answerId:u,questionResult:3,runNumber:0,codeLines:0,userQuestionId:this.reportProviderData.id,answerCode:"",questionScene:203,questionType:306,questionId:this.reportProviderData.questionId,questionOrdinal:-1,errorRunNumber:0,sectionId:Number(o)},f={bizId:c,bizType:1,ybcLessonId:Number(a),userId:l,questionInfo:d,missionType:s,userMissionId:r};P.default.getAppInstance().getAppConfig().then((function(e){var n=e.productId;f.productId=n,setTimeout((function(){t.props.questionComplete()}),120),(0,g.reportQuestionAnswerData)(f)})).catch((function(e){A.default.info("[reportQuestionAnswerData] error",f,e),t.props.questionComplete()}))}catch(e){A.default.info("[reportQuestionAnswerData] error",e),this.props.questionComplete()}}},{key:"showCase",value:function(){this.hasShowCase||(this.pauseVideo(),this.gameContainer.style.display="",this.hasShowCase=!0,A.default.info("showCase"+this.hasShowCase),this.initGame(),this.setState({showToggle:!1,isPlaying:!1,caseFinished:!0}))}},{key:"hideCase",value:function(){this.hasShowCase||(this.hasShowCase=!1,this.gameContainer.style.display="none")}},{key:"initGame",value:function(){var e=this,t=this.state.gamePath;t&&I.default.init(t,(function(t){e.game=t,A.default.info("initGame")}),(function(t){A.default.info("initGame error",t),e.props.questionInitedFailed()}))}},{key:"forceHideCase",value:function(){this.hasShowCase=!1,this.gameContainer.style.display="none",this.setState({caseStartTime:-1})}},{key:"toggleVideo",value:function(){var e=this.state.isPlaying;e?this.pauseVideo():this.playVideo(),this.setState({isPlaying:!e})}},{key:"startTimeWatch",value:function(){var e=this;this.stopTimeWatch(),this._timeTask=setInterval((function(){e.isEnd?e.stopTimeWatch():e.updateTime()}),50)}},{key:"stopTimeWatch",value:function(){window.clearInterval(this._timeTask)}},{key:"onVideoPlay",value:function(){this.setState({isPlaying:!0})}},{key:"playEnd",value:function(){var e=this.state,t=e.caseStartTime,n=e.caseFinished;this.isEnd=!0,"number"==typeof t?(parseInt(this.videoRef.current.duration),n?(this.stopTimeWatch(),this.submitAnswer(),this.setState({isPlaying:!1,showToggle:!0,caseFinished:!1})):this.showCase()):this.showCase()}},{key:"playError",value:function(){if(this.setState.videoUrl){var e=this.videoRef.current.error;A.default.info("playError",e),this.props.questionInitedFailed()}}},{key:"updateTime",value:function(){var e=this.state,t=e.videoUrl,n=e.caseTimeRange,i=e.caseFinished;if(t){var a=this.videoRef.current.currentTime;a>=this.videoRef.current.duration&&this.stopTimeWatch(),!i&&a>=n.start&&a<n.end&&this.showCase()}}},{key:"bindVideoLoadEvent",value:function(){var e=this;this.videoRef.current.addEventListener("loadedmetadata",(function(){e.trySendReadyEvent(!0)}))}},{key:"handleAnswerEnd",value:function(){this.isGameOver=!0,clearTimeout(this.nextTimer),(0,w.default)(w.FROG_EVENTS.CLICK_FINISH),this.submitAnswer()}},{key:"backNormalVideo",value:function(){this.videoRef.current&&this.videoRef.current.pause(),this.props.questionExit(),this.setState({isPlaying:!1}),this.state.hasShowCase&&I.default.stopGameRunning()}},{key:"handleNext",value:function(){(0,w.default)(w.FROG_EVENTS.CLICK_SKIP_GAME)}},{key:"playVideo",value:function(){this.videoRef.current&&this.videoRef.current.play(),this.startTimeWatch()}},{key:"pauseVideo",value:function(){this.videoRef.current&&this.videoRef.current.pause(),this.stopTimeWatch()}},{key:"render",value:function(){var e=this.state,t=e.videoUrl,n=e.isPlaying,i=e.showToggle,a=e.safetyLeftArea,o=(0,v.default)(S.default.btnControl,n?S.default.pause:S.default.play);return h.default.createElement("div",null,h.default.createElement("div",{className:(0,v.default)(S.default.backCircleBtn,(0,s.default)({},S.default.aiBackCircleBtn,P.default.isAIApp())),style:{marginLeft:a},onClick:this.backNormalVideo}),h.default.createElement("div",{className:S.default.incentiveContainer,ref:this.incentiveViewRef}),h.default.createElement("div",{className:S.default.videoContainer,ref:this.videoContainerRef},t&&h.default.createElement("video",{ref:this.videoRef,className:S.default.video,onPlay:this.onVideoPlay,onEnded:this.playEnd,onError:this.playError,playsInline:!0,preload:"auto",src:t,"x5-video-player-type":"h5",webkitplaysinline:"true"}),i&&h.default.createElement("div",{className:o,style:{marginLeft:a},onClick:this.toggleVideo})))}}]),a}(h.Component);O.propTypes={onNativeEvent:m.default.func,questionInitedFailed:m.default.func,questionComplete:m.default.func,questionInited:m.default.func,questionExit:m.default.func};var q=(0,C.default)(O);t.default=q},99185:function(e,t,n){"use strict";var i=n(95318),a=n(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e){if("[object Object]"===Object.prototype.toString.call(t))for(var n in t)t[n]="".concat(t[n]);return void 0!==u.find((function(e){return location.host===e}))||s.default.isYBCApp()?c(e,t):void 0}};var o=a(n(11831)),s=i(n(63017)),r=i(n(56189)),u=["ke.yuanfudao.biz","steam.yuanfudao.com"],c=function(e,t){if(o.isInnerApp)o.default.exec("ajaxPostFrog",{url:e,params:t});else if(s.default.isYBCApp()){var n=r.default.parseWebAppInfo(),i={ybcEpisodeId:r.default.commonQueryParams.ybcEpisodeId,episodeType:r.default.commonQueryParams.episodeType,sectionId:r.default.commonQueryParams.sectionId,questionMissionUserID:r.default.commonQueryParams.userMissionId,questionTypes:n.appId,questionWebAppidVersion:n.appVersion,questionType:"251",lessonId:r.default.commonQueryParams.ybcLessonId,answerScene:"12"===r.default.commonQueryParams.missionType?"思维启蒙":"录播"};s.default.sendFrog(e,Object.assign(i,t))}}},29112:function(e,t,n){"use strict";var i=n(20862),a=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"minilog",{enumerable:!0,get:function(){return f.default}}),t.default=void 0;var o=a(n(50008)),s=a(n(319)),r=a(n(34575)),u=a(n(93913)),c=a(n(2205)),l=a(n(78585)),d=a(n(29754)),f=a(n(60170)),p=n(17187),h=i(n(11831)),m=a(n(63017));var v=function(e){(0,c.default)(a,e);var t,n,i=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,d.default)(t);if(n){var a=(0,d.default)(this).constructor;e=Reflect.construct(i,arguments,a)}else e=i.apply(this,arguments);return(0,l.default)(this,e)});function a(){var e;return(0,r.default)(this,a),(e=i.call(this)).defaultAbstract="LOG",e.postfix="href: ".concat(location.href),e.divide="|",e}return(0,u.default)(a,[{key:"write",value:function(e,t,n){var i=(0,s.default)(n),a=i.shift()||this.defaultAbstract;if(["info","error","warn"].includes(t)){var o=this.parseArgs(i);if(h.isInnerApp)h.default.exec("aliyunLog",{logString:"[".concat(e,"] [").concat(t,"] [").concat(a,"] ").concat(o)}).catch((function(e){/TIMEOUT/i.test(e)}));else if(m.default.isYBCApp())try{m.default.sendDebugLog("[".concat(e,"] [").concat(t,"] [").concat(a,"] ").concat(o))}catch(e){console.error(e)}}}},{key:"parseArgs",value:function(e){var t=this;return e.push(this.postfix),e.reduce((function(e,n){try{var i=n;switch((0,o.default)(n)){case"object":if(n instanceof Error){i=JSON.stringify(n,Object.getOwnPropertyNames(n)),n.toString instanceof Function&&(i+=n.toString()),n.valueOf instanceof Function&&(i+=n.valueOf()),n.error&&(i+=n.error.stack);var a=n.target&&n.target.localName;"link"===a?i+="link="+n.target.href:"script"===a&&(i+="script="+n.target.src)}else i=JSON.stringify(n);break;case"function":i="(Function ".concat(n.name,")")}return"".concat(e," ").concat(t.divide," ").concat(i)}catch(t){return console.warn("parseArgs err",n),e}}),"")}}]),a}(p.EventEmitter);f.default.pipe(new v),window.$minilog=(0,f.default)("ada-video-interactive");var y=window.$minilog;t.default=y},42191:function(e,t,n){"use strict";var i=n(95318),a=n(20862);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,s,r,u=n(61658),c=n(30436),l=n(95208),d=a(n(8733)),f=i(n(56189));s="production",r={dsn:"https://f405e550631747d5b7b548129eb8d048@sentry-fe.yuanfudao.com/387",integrations:[new u.Integrations.BrowserTracing,new c.CaptureConsole({levels:["error"]})],tracesSampleRate:1,environment:s,release:"production@2025-06-17 17:56:22"},["production","test"].includes(s)&&d.init(r),null!==(o=f.default.commonQueryParams)&&void 0!==o&&o.sectionId&&d.setTag("sectionId",f.default.commonQueryParams.sectionId),l.user&&l.user.getUserId().then((function(e){e&&(window.userId=e,d.setTag("userId",e))})).catch((function(e){console.error(e)})),window.Sentry||(window.Sentry=d);var p=d;t.default=p},56189:function(e,t,n){"use strict";var i=n(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n(319)),o=i(n(63038)),s=i(n(50008)),r=i(n(59713)),u=i(n(17563)),c=n(21614),l=i(n(41875)),d=n(95208),f=n(11831),p=i(n(63017)),h=i(n(29112));function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=v({_productId:1222,_hostProductId:1222,version:"0.1.0",UDID:(0,c.v4)()},u.default.parse(window.location.search)),g={method:"get",headers:{"Content-Type":"application/json"},timeout:1e4,withCredentials:!0,withCommonQuery:!0,baseUrl:""},C=JSON.parse(JSON.stringify(g)),w=function(e,t){var n=e.url,i=e.method,a=e.headers,s=e.body,r=e.timeout,u=setTimeout((function(){t("iosJsonAjax timeout")}),r);(0,f.ajaxPostJSON)(n,i,a,s,r).then((function(e){var n=(0,o.default)(e,2),i=n[0],a=n[1];t(null,{statusCode:i,body:a})})).catch((function(e){t(e),clearTimeout(u)})).then((function(){clearTimeout(u)}))},b=function(e,t){var n=e.url,i=e.method,a=e.body,o=e.timeout,s=setTimeout((function(){t("ybcAjax timeout")}),o);return("POST"===i?d.network.requestByClient.post(n,a,e):d.network.requestByClient.get(n,e)).then((function(e){t(null,{statusCode:e.status,body:e.data}),clearTimeout(s)})).catch((function(e){clearTimeout(s),t(e)}))},S=function(e,t){var n=e.href_,i=e.search_,s=e.headers,u=e.body,c=e.timeout,l=setTimeout((function(){t("iosFileAjax timeout")}),c);Promise.all((0,a.default)(u.keys()).map((function(e){var t=u.get(e);return function(e){return new Promise((function(t,n){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return n(e)}}))}(t).then((function(n){var i;return i={},(0,r.default)(i,e,n.split(",")[1]),(0,r.default)(i,"fileName",t.name),i}))}))).then((function(e){var a=e.reduce((function(e,t){return Object.assign(e,t)}),{}),r="".concat(n,"/base64?").concat(i);(0,f.ajaxPostFile)(r,s,a,c).then((function(e){var n=(0,o.default)(e,2),i=n[0],a=n[1];t(null,{statusCode:i,body:a})})).catch((function(e){t(e)})).then((function(){clearTimeout(l)}))}))},I=function(e,t){var n=v(v({},C),t),i=u.default.stringify(v(v({},n.withCommonQuery?y:{}),t.params));n.href_=e,/^http/.test(e)||(e="".concat(n.baseUrl).concat(e)),n.url="".concat(e,"?").concat(i),n.search_=i,n.method=n.method.toUpperCase(),n.headers&&"application/json"===n.headers["Content-Type"]&&"object"===(0,s.default)(n.body)&&!p.default.isYBCApp()&&(n.body=JSON.stringify(n.body));var a=l.default;f.isInnerApp&&f.isIOS&&["POST","PUT","DELETE"].includes(n.method)&&t.body?a=n.headers&&"application/json"===n.headers["Content-Type"]?w:S:p.default.isYBCApp()&&(a=b);var o=(0,c.v1)(),r=["XHR",n.method,"requestId: ".concat(o),n.href_];return new Promise((function(e,t){var i=Date.now();a(n,(function(n,a){var o=Date.now()-i;if(n)return h.default.error.apply(h.default,r.concat(["request-error: ".concat(n),"duration: ".concat(o,"ms")])),t(n);var u=a.body;if(200!==a.statusCode)return h.default.error.apply(h.default,r.concat(["request-error: response status is ".concat(a.statusCode),"duration: ".concat(o,"ms")])),t(a);if("object"!==(0,s.default)(u))try{u=JSON.parse(u)}catch(e){console.warn("parse body error",e)}return e(u)}))}))},P=function(e){return function(t,n){return I(t,v(v({},n),{},{method:e}))}},R={setOptions:function(e){e&&"object"===(0,s.default)(e)&&Object.keys(e).forEach((function(t){var n=e[t];"headers"===t?C.headers=v(v({},g.headers),n):void 0!==n&&(C[t]=n)}))},request:I,post:P("post"),get:P("get"),delete:P("delete"),put:P("put"),parseWebAppInfo:function(){var e=location.pathname.match(/\.([0-9]+)\.([0-9]{1,4})/);return{appId:e[1]||"",appVersion:e[2]||""}},commonQueryParams:y};t.default=R},41227:function(e,t,n){"use strict";n.r(t),t.default={app:"style_app_3RXP5"}},26434:function(e,t,n){"use strict";n.r(t),t.default={container:"style_container_2QI1j",backCircleBtn:"style_backCircleBtn_3WBDR",aiBackCircleBtn:"style_aiBackCircleBtn_3EsTF",incentiveContainer:"style_incentiveContainer_IHm9X","video-container":"style_video-container_1x59Q",videoContainer:"style_video-container_1x59Q",video:"style_video_2aAPN","btn-control":"style_btn-control_3G9pk",btnControl:"style_btn-control_3G9pk",play:"style_play_14uK5",pause:"style_pause_v1y_R"}},12482:function(){}},function(e){"use strict";e.O(0,[698,913],(function(){return 7643,e(e.s=7643)})),e.O()}]);