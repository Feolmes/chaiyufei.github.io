{"version":3,"sources":["webpack:///./src/lib/app-util.js","webpack:///./src/lib/game-runtime-loader.js","webpack:///./src/lib/helper.js","webpack:///./src/lib/webview.js","webpack:///./src/pages/polyfill.js","webpack:///./src/pages/video/api/frog.js","webpack:///./src/pages/video/api/index.js","webpack:///./src/pages/video/api/question.js","webpack:///./src/pages/video/hoc/webview-life-hoc.jsx","webpack:///./src/pages/video/index.jsx","webpack:///./src/pages/video/public-path.js","webpack:///./src/pages/video/view/view.jsx","webpack:///./src/services/frog.js","webpack:///./src/services/logger.js","webpack:///./src/services/sentry.js","webpack:///./src/services/xhr.js","webpack:///./src/pages/video/style.css","webpack:///./src/pages/video/view/style.css"],"names":["AppUtils","init","isYBCApplication","application","getAppConfig","then","obj","version","appVersion","console","log","isYBCApp","isSafeAppVersion","checkNotAllowVersion","this","isYMMApp","isInnerApp","isMute","callback","system","getMuteState","mutedInfo","muted","err","error","getAppInstance","getSafeArea","getSystemInfo","systemInfo","screen","safeArea","screenScale","left","top","getLocalResource","filename","store","getResource","Promise","reject","emitComplete","minilog","info","lifecycle","webview","execWithTimeout","isAIApp","isYBCAIApplication","emitError","emitExit","emitReady","emitExitRoom","sectionId","status","sendBehavior","record","sendBehaviorFrog","JSON","stringify","sectionActDetail","result","sendFrog","event","params","frog","arr","Object","keys","forEach","k","push","key","value","send","onStart","addNativeEventListener","window","onResume","onPause","onBeforeSystemBack","clientEvent","on","resolve","onExitDialogCancel","onBeforeExit","handler","timeout","sendDebugLog","str","showAppToast","msg","toast","pendingMessage","lastCaseState","submitCaseState","gamePath","readyCallback","errorCallback","_path","test","_createScript","_initGame","isReady","hasCallReady","startListenGameReady","getRequestByClient","url","config","network","requestByClient","get","postRequestByClient","data","post","loadRemoteCaseState","saveRemoteCaseState","state","type","Phaser","Auto","width","height","scale","mode","Scale","FIT","zoom","isIPad","isIOS15","undefined","dom","createContainer","transparent","parent","game","Game","events","once","loadCompleteHandler","bind","addScene","src","script","document","createElement","body","appendChild","onload","onerror","formatErrorInfo","Sentry","captureException","interval","checkGameSceneReady","scene","scenes","length","clearInterval","load","setTimeout","setInterval","clearPendingMessage","dispatchGameMessage","message","emit","join","item","stopGameRunning","resumeGameRunning","startGameRunning","func","timer","args","clearTimeout","apply","seconds","split","map","a","index","parseInt","Math","pow","videoUrl","successCallback","fetch","response","blob","res","URL","createObjectURL","navigator","userAgent","indexOf","createImageBitmap","logStr","errorInfo","lineno","colno","stack","isTrusted","toString","Function","valueOf","typeName","target","localName","href","adaWebview","checkApi","isAndroid","fromLast","success","methodNames","methodName","initMethod","name","call","initMethods","EVENT_ENTER_QUESTION","CLICK_BACK_BUTTON","CLICK_EXIT","CLICK_CANCEL_EXIT","CLICK_PASS_QUESTION","CLICK_FINISH","environment","env","baseUrl","xhr","setOptions","answer","commonQueryParams","userMissionId","missionTemplateQuestionId","WrappedComponent","matrix","addEventListener","onIframeEvent","location","removeEventListener","setState","content","questionStart","questionResume","questionPause","AppUtil","FROG_EVENTS","onNativeEvent","questionInited","questionComplete","questionInitedFailed","questionExit","props","Component","appTarget","className","styles","app","ReactDOM","render","__webpack_public_path__","module","exports","OFFSET","View","gameContainer","querySelector","isPlayQuestion","hasNext","questionScratch","answerScratch","showBCLineBack","remoteVideoUrl","caseStartTime","caseTimeRange","start","end","isPlaying","showToggle","safetyLeftArea","questionContent","hasShowCase","skipDuration","isGameOver","nextTimer","questionPlayer","answerPlayer","videoRef","createRef","videoContainerRef","incentiveViewRef","fetchData","prevProps","initData","showMatrixBtn","setCanvas","videoPlay","destroy","isEnd","submitAnswer","forceHideCase","playVideo","_showToggle","debounce","current","pause","GameRuntimeLoader","area","visibilityState","focusoutHandler","isIOS","scrollTo","behavior","match","warning","resume","player","fetchContent","parse","reportProviderData","latestAnswer","questionStartTime","Date","getTime","temp","timeStr2Seconds","videoCase","caseArr","startTime","mainVideo","fileName","replace","gameCDNUrl","localFileName","pop","localFilePath","Error","handleVideo","trySendReadyEvent","stageY","caseFinished","userId","setTag","useBlob","parseFloat","String","checkQQBrowser","preloadVideo","localUrl","bindVideoLoadEvent","innerHeight","innerWidth","container","getElementById","style","isVideoLoaded","isNeedHideCase","showCase","hideCase","showExtraBtn","CLICK_PLAY_QUESTION","answerQuestion","userQuestionId","id","userQuestionAnswerRoundId","timeElapsed","userSectionId","showIncentiveView","reportQuestionAnswerData","answerId","hasCoin","incentiveType","score","options","onClose","stars","coin","BCIncentiveView","injectValue","queryObj","ybcEpisodeId","ybcLessonId","missionType","bizId","Number","questionInfo","endTime","questionResult","runNumber","codeLines","answerCode","questionScene","questionType","questionId","questionOrdinal","errorRunNumber","dataContent","bizType","productId","pauseVideo","display","initGame","stopTimeWatch","_timeTask","updateTime","duration","currentTime","CLICK_SKIP_GAME","play","startTimeWatch","playCls","btnControl","backCircleBtn","aiBackCircleBtn","marginLeft","onClick","backNormalVideo","incentiveContainer","ref","videoContainer","video","onPlay","onVideoPlay","onEnded","playEnd","onError","playError","playsInline","preload","x5-video-player-type","webkitplaysinline","toggleVideo","propTypes","PropTypes","frogUrlType","prototype","whiteList","find","host","ajaxPostFrog","exec","parseWebAppInfo","commonParams","episodeType","questionMissionUserID","questionTypes","appId","questionWebAppidVersion","lessonId","answerScene","assign","AliyunLog","defaultAbstract","postfix","divide","level","logs","abstract","shift","includes","detail","parseArgs","logString","reduce","acc","cur","getOwnPropertyNames","e","warn","EventEmitter","pipe","$minilog","process","dsn","integrations","Integrations","BrowserTracing","CaptureConsole","levels","tracesSampleRate","release","user","getUserId","_productId","_hostProductId","UDID","queryString","search","defaultOptions","method","headers","withCredentials","withCommonQuery","xhrOptions","iosJsonAjax","opts","ajaxPostJSON","code","statusCode","ybcAjax","iosFileAjax","href_","search_","formData","all","file","reader","FileReader","readAsDataURL","toBase64","base64","pre","ajaxPostFile","request","qs","toUpperCase","ajax","requestId","logarr","now","logger","requestWithMethod","opt","delete","put","pathname"],"mappings":"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","file":"index.faa006784810493073e6.js","sourcesContent":["/**\n * APP 聚合库，兼容处理大编程小编程的 API 不一致性\n * */\n\n import { isYBCApplication, lifecycle, record, clientEvent, frog, log, system, application, store, toast, isYBCAIApplication} from '@ybc/client-api';\n import webview, { isInnerApp } from '@lib/webview.js';\n import { checkNotAllowVersion } from './helper';\n import minilog from '@/services/logger.js';\n\nconst AppUtils = {\n  init() {\n    if (isYBCApplication()) {\n      application.getAppConfig().then(obj => {\n        this.version = obj.appVersion;\n        console.log(this.version);\n      })\n    }\n  },\n  // 大编程客户端\n  isYBCApp() {\n      return isYBCApplication();\n  },\n\n  isSafeAppVersion() {\n    return !checkNotAllowVersion(this.version);\n  },\n\n  // 小编程客户端\n  isYMMApp() {\n    return isInnerApp;\n  },\n\n  isMute(callback) {\n    if (isYBCApplication()) {\n      system.getMuteState().then((mutedInfo) => {\n        console.log(\"app-system\", \"mutedInfo\", mutedInfo)\n        callback(mutedInfo.muted);\n      }).catch(err => {\n        console.error(err);\n      })\n    }\n  },\n\n  // 获取 app 实例\n  getAppInstance() {\n      return application;\n  },\n\n  // 获取安全边距\n  getSafeArea(callback) {\n    if (isYBCApplication()) {\n      system.getSystemInfo().then((systemInfo) => {\n        const { screen: { safeArea, screenScale } } = systemInfo;\n        if (safeArea.left > 0) {\n          safeArea.left = safeArea.left / screenScale\n        }\n        if (safeArea.top > 0) {\n          safeArea.top = safeArea.top / screenScale\n        }\n        callback(safeArea);\n      })\n    } else if (isInnerApp) {\n      // TODO\n      callback({});\n    }\n  },\n\n  getLocalResource(filename) {\n    if (isYBCApplication() && !checkNotAllowVersion(this.version)) {\n      return store.getResource(filename)\n    }\n    return Promise.reject()\n  },\n\n  // 通知题目完成\n  emitComplete() {\n    minilog.info('emitComplete');\n    if (isYBCApplication()) {\n      lifecycle.emitComplete()\n    } else if (isInnerApp) {\n      webview.execWithTimeout('questionInited', -1);\n    }\n  },\n  isAIApp() {\n    return isYBCAIApplication && isYBCAIApplication();\n  },\n\n  // 通知题目完成\n  emitError() {\n    minilog.info('emitError');\n    if (isYBCApplication()) {\n      lifecycle.emitError()\n    } else if (isInnerApp) {\n      webview.execWithTimeout('questionInitedFailed', -1);\n    }\n  },\n\n  // 通知退出题目\n  emitExit() {\n    minilog.info('emitExit');\n    if (isYBCApplication()) {\n      lifecycle.emitExit();\n    } else if (isInnerApp) {\n      webview.execWithTimeout('closeWebView', -1);\n    }\n  },\n\n  // 通知准备就绪\n  emitReady() {\n    minilog.info('emitReady');\n    if (isYBCApplication()) {\n      lifecycle.emitReady();\n    } else if (isInnerApp) {\n      webview.execWithTimeout('questionInited', -1);\n    }\n  },\n\n  // 通知退出教室\n  emitExitRoom(sectionId) {\n    minilog.info('emitExitRoom');\n    if (isYBCApplication()) {\n      lifecycle.emitExitRoom(sectionId);\n    } else if (isInnerApp) {\n      webview.execWithTimeout('questionComplete', {\n        status: \"success\"\n      });\n    }\n  },\n\n  // 上报用户行为\n  sendBehavior(sectionId) {\n    if (isYBCApplication()) {\n      try {\n        record.sendBehaviorFrog(\"actInSection\", \"\" + sectionId, JSON.stringify({\n          sectionActDetail: {\n            result: 3\n          }\n        }))\n      } catch (err) {\n        console.error(err)\n      }\n    }\n  },\n\n  // 发送埋点\n  sendFrog(event, params = {}) {\n    if (typeof frog == 'object' && frog) {\n      const arr = []\n      Object.keys(params).forEach((k) => {\n        arr.push({\n          key: k,\n          value: params[k]\n        })\n      });\n      frog.send(event, arr)\n    }\n  },\n\n  // native 通知题目开始\n  onStart(callback) {\n    minilog.info('onStart');\n    if (isYBCApplication()) {\n      lifecycle.onStart(callback);\n    } else if (isInnerApp) {\n      webview.addNativeEventListener('questionStart', callback);\n    }\n    window.onStart = () => {\n      callback();\n    }\n  },\n\n  // native 通知题目开始\n  onResume(callback) {\n    if (isYBCApplication()) {\n      // TODO\n    } else if (isInnerApp) {\n      webview.addNativeEventListener('questionResume', callback);\n    }\n  },\n\n  onPause(callback) {\n    if (isYBCApplication()) {\n      // TODO\n    } else if (isInnerApp) {\n      webview.addNativeEventListener('questionPause', callback);\n    }\n  },\n\n  // 系统返回回调\n  onBeforeSystemBack(callback) {\n    if (isYBCApplication()) {\n      clientEvent.on('before-system-back', () => {\n        callback();\n        return Promise.resolve(true)\n      })\n    }\n  },\n\n  // 通知题目退出前的任务\n  onExitDialogCancel(callback) {\n    minilog.info('onExitDialogCancel');\n    if (isYBCApplication()) {\n      lifecycle.onExitDialogCancel(callback);\n    } else if (isInnerApp) {\n      // TODO\n    }\n  },\n\n  // native 通知题目要退出了，题目保存状态后完成退出\n  onBeforeExit(handler, timeout) {\n    if (!timeout) {\n      timeout = 5000\n    }\n    if (isYBCApplication()) {\n      lifecycle.onBeforeExit(handler, timeout);\n    }\n  },\n\n  // 发送开发日志\n  sendDebugLog(str) {\n    if (isYBCApplication()) {\n      // 第二个参数不能为空\n      log.info('ada-video-interactive', str);\n    }\n  },\n\n  showAppToast(msg) {\n    if (isYBCApplication()) {\n      // 第二个参数不能为空\n      console.log(\"showAppToast\", msg)\n      toast.info(msg);\n    }\n  }\n}\nAppUtils.init();\n\nexport default AppUtils;\n","import { isIPad, isIOS15, formatErrorInfo } from \"./helper\";\nimport { network } from \"@ybc/client-api\";\nimport minilog from \"../services/logger.js\";\n\nconst GameRuntimeLoader = {\n    pendingMessage: [],\n    lastCaseState: null,\n    submitCaseState: null,\n\n    init(gamePath, readyCallback, errorCallback) {\n        minilog.info(\"GameRuntimeLoader init\", gamePath);\n        if (!gamePath) {\n            errorCallback(\"error gamePath\");\n            return;\n        }\n        this.gamePath = gamePath;\n        this._path = this.gamePath;\n        if (!/\\//.test(this.gamePath)) {\n            this._path = \"./gameAssets/\" + this.gamePath;\n        }\n        this._createScript(\n            this._path + \"/javascript/index.js\",\n            () => {\n                this._initGame();\n            },\n            errorCallback\n        );\n        this.readyCallback = readyCallback;\n        this.isReady = false; // 是否初始化完成 控制给case发送消息或者缓存消息\n        this.hasCallReady = false; // 是否已经调用过readyCallback\n        this.errorCallback = errorCallback;\n        this.startListenGameReady();\n    },\n\n    /**\n     * @param {*} url get请求的url\n     * @param {*} config? 可选配置\n     * @return {*} promise\n     */\n    getRequestByClient(url, config) {\n        minilog.info(\n            \"GameRuntimeLoader getRequestByClient\",\n            url,\n            JSON.stringify(config)\n        );\n        return network.requestByClient.get(url, config);\n    },\n\n    /**\n     * @param {*} url post请求url\n     * @param {*} data post请求参数\n     * @param {*} config？可选配置\n     * @return {*} promise\n     */\n    postRequestByClient(url, data, config) {\n        minilog.info(\n            \"GameRuntimeLoader postRequestByClient\",\n            url,\n            JSON.stringify(data),\n            JSON.stringify(config)\n        );\n        return network.requestByClient.post(url, data, config);\n    },\n\n    async loadRemoteCaseState() {\n        minilog.info(\n            \"GameRuntimeLoader loadRemoteCaseState\",\n            this.lastCaseState\n        );\n        return this.lastCaseState || null;\n    },\n\n    async saveRemoteCaseState(state) {\n        minilog.info(\"GameRuntimeLoader saveRemoteCaseState\", state);\n        // 如果不是string类型，则转换为json字符串, 否则提交接口会报错\n        if (typeof state !== 'string') {\n            state = JSON.stringify(state);\n        }\n        this.submitCaseState = state;\n    },\n\n    _initGame() {\n        var config = {\n            type: Phaser.Auto,\n            width: 1920,\n            height: 1080,\n            scale: {\n                mode: Phaser.Scale.FIT,\n                zoom: isIPad() && isIOS15() ? 0.5 : undefined,\n            },\n            dom: { createContainer: true },\n            transparent: true,\n            parent: \"game-container\",\n        };\n        var game = new Phaser.Game(config);\n        // 添加case load完成事件监听\n        game.events.once(\"caseInitComplete\", () => {\n            this.loadCompleteHandler(\"caseInitComplete\");\n        });\n        game.loadRemoteCaseState = this.loadRemoteCaseState.bind(this);\n        game.saveRemoteCaseState = this.saveRemoteCaseState.bind(this);\n        this.game = game;\n        // 需要上升到全局进行管控\n        window.game = game;\n        addScene(\n            game,\n            this._path,\n            this.getRequestByClient,\n            this.postRequestByClient\n        );\n    },\n\n    _createScript(src, callback, errorCallback) {\n        const script = document.createElement(\"script\");\n        script.src = src;\n        document.body.appendChild(script);\n        script.onload = function () {\n            minilog.info(\"GameRuntimeLoader _createScript onload\", src);\n            callback && callback();\n        };\n        script.onerror = (err) => {\n            console.error(err);\n            minilog.info(\n                \"GameRuntimeLoader _createScript error \",\n                formatErrorInfo(err)\n            );\n            Sentry.captureException(err);\n            errorCallback && errorCallback(err);\n        };\n    },\n\n    startListenGameReady() {\n        let interval = 0;\n        const checkGameSceneReady = () => {\n            if (this.game?.scene?.scenes?.length > 0) {\n                clearInterval(interval);\n                minilog.info(\"GameRuntimeLoader startListenGameReady listener\");\n                try {\n                    this.game.scene.scenes[0].load.on(\"complete\", () => {\n                        this.loadCompleteHandler(\"onSceneComplete\");\n                    });\n                    this.game.scene.scenes[0].load.on(\"loaderror\", (error) => {\n                        const info = formatErrorInfo(error);\n                        minilog.info(\n                            \"GameRuntimeLoader startListenGameReady loaderror \",\n                            info\n                        );\n                        Sentry.captureException(error);\n                        // fix 同时触发loaderror和complete情况\n                        error && this.errorCallback(error);\n                    });\n                } catch (err) {\n                    minilog.info(\n                        \"GameRuntimeLoader startListenGameReady error \",\n                        err\n                    );\n                    this.errorCallback(err);\n                }\n                setTimeout(() => {\n                    if (!this.hasCallReady) {\n                        minilog.info(\n                            \"GameRuntimeLoader startListenGameReady timeout invoke\"\n                        );\n                        this.readyCallback(this.game);\n                    }\n                }, 2000);\n            }\n        };\n        checkGameSceneReady();\n        if (!this.game?.scene?.scenes?.length) {\n            // 定时器监听\n            interval = setInterval(checkGameSceneReady, 10);\n        }\n    },\n\n    // case加载完成逻辑，scene complete 事件触发或者case主动emit\n    loadCompleteHandler(type) {\n        minilog.info(\n            `GameRuntimeLoader loadCompleteHandler type=${type} hasCallReady=${this.hasCallReady}`\n        );\n        if (this.hasCallReady) return;\n        this.hasCallReady = true;\n        this.readyCallback(this.game);\n        this.isReady = true;\n        this.clearPendingMessage();\n    },\n\n    // 进行游戏的消息控制\n    dispatchGameMessage(message) {\n        if (!this.isReady) {\n            minilog.info(\"GameRuntimeLoader pendingMessage\", message);\n            this.pendingMessage.push(message);\n        } else {\n            minilog.info(\"GameRuntimeLoader emitMessage\", message);\n            this.game.events.emit(message);\n        }\n    },\n\n    clearPendingMessage() {\n        minilog.info(\n            \"GameRuntimeLoader clearPendingMessage\",\n            this.pendingMessage.join(\".\")\n        );\n        this.pendingMessage.forEach((item) => {\n            this.dispatchGameMessage(item);\n        });\n        this.pendingMessage = [];\n    },\n\n    // 暂停游戏运行\n    stopGameRunning() {\n        this.dispatchGameMessage(\"interaction-pause\");\n    },\n\n    // 恢复游戏运行\n    resumeGameRunning() {\n        this.dispatchGameMessage(\"interaction-resume\");\n    },\n\n    // 通知游戏开始\n    startGameRunning() {\n        minilog.info(\"GameRuntimeLoader before startGameRunning\");\n        this.dispatchGameMessage(\"questionStart\");\n        // 兜底PC切进度 导致scene complete 事件不触发问题\n        // 2025-02-06 部分题目加载资源较多，超时时间设置为10s\n        setTimeout(() => {\n            if (!this.hasCallReady) {\n                minilog.info(\n                    \"GameRuntimeLoader startGameRunning timeout invoke\"\n                );\n                this.hasCallReady = true;\n                this.isReady = true;\n                this.clearPendingMessage();\n            }\n        }, 10 * 1000);\n    },\n};\n\nexport default GameRuntimeLoader;\n","export function debounce(func, timeout = 500) {\n  let timer;\n  return (...args) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => { func.apply(this, args); }, timeout);\n  };\n};\n\nexport function timeStr2Seconds(str) {\n  let seconds = 0\n  try {\n    // 教研现在第三位是毫秒，不参与计算\n    str && str.split(\":\").map((a, index) => {\n      if (index == 2) {\n        seconds += parseInt(a) / 100;\n        return;\n      }\n      seconds += parseInt(a) * Math.pow(60, 1 - index)\n    });\n  } catch (err) {\n    console.log(err);\n  }\n  return seconds;\n}\n\nexport function preloadVideo(videoUrl, successCallback, errorCallback) {\n  fetch(videoUrl).then((response) => {\n    response.blob().then((res) => {\n      successCallback(URL.createObjectURL(res));\n    });\n  }).catch((err) => {\n    console.error(err);\n    errorCallback(err);\n  });\n}\n\nexport function checkQQBrowser() {\n  return navigator.userAgent.indexOf(\"MQQ\") !== -1;\n}\n\nexport function isMobile() {\n  return /iPhone|iPad|Android/i.test(navigator.userAgent)\n}\n\nexport function isIPad() {\n  return /iPad/i.test(navigator.userAgent)\n}\n\nexport function isIOS15() {\n  return typeof createImageBitmap === 'function' && /iPhone|iPad/i.test(navigator.userAgent)\n}\n\nexport function checkNotAllowVersion(version) {\n  return [\"3.1.0\", \"3.2.0\", \"3.0.0\", \"3.3.0\", \"3.2.1\"].indexOf(version) != -1\n}\n\n// 日志转换错误信息\nexport function formatErrorInfo(error) {\n  var logStr = '';\n  var errorInfo = {\n    message: error.message,\n    filename: error.filename,\n    lineno: error.lineno,\n    colno: error.colno,\n    stack: error.error && error.error.stack,\n    isTrusted: error.isTrusted,\n  };\n  logStr += \"errorInfo=\" + JSON.stringify(errorInfo);\n  if (error.toString instanceof Function) {\n    logStr += \"toString=\" + error.toString();\n  }\n  if (error.valueOf instanceof Function) {\n    logStr += \"valueOf=\" + error.valueOf();\n  }\n  var typeName = error.target?.localName; // 资源404的类型\n  if (typeName === \"link\") {\n    logStr += \"link=\" + error.target.href;\n  } else if (typeName === \"script\") {\n    logStr += \"script=\" + error.target.src;\n  }\n  // 其他的错误情况\n  const { src } = error;\n  if (src) {\n    logStr += \"src=\" + src;\n  }\n  return logStr;\n}","import adaWebview, { isAndroid, isIOS, isInnerApp, ajaxPostFile, ajaxPostJSON } from '@fenbi/ada-steam-webview';\n\n// 判断是否有播放视频的api\nexport function hasPlayVideoApi() {\n  return new Promise((resolve) => {\n    resolve(adaWebview.checkApi('startPlayVideo') && (!isAndroid || adaWebview.checkApi('getDeviceInfo')));\n  });\n}\n\nexport function playNativeVideo(url, fromLast = false) {\n  return new Promise((resolve, reject) => {\n    adaWebview.execWithTimeout(\n      'startPlayVideo',\n      -1,\n      { url, fromLast },\n      (error, success) => {\n        if (success) {\n          resolve(true);\n        }\n        if (error) {\n          reject(error);\n        }\n      },\n    );\n  });\n}\nclass WebviewProxy {\n  constructor(webview) {\n    this.webview = webview;\n  }\n\n  initMethods(methodNames) {\n    methodNames.forEach((methodName) => {\n      this.initMethod(methodName);\n    });\n  }\n\n  initMethod(name) {\n    this[name] = function (...args) {\n      return this.webview[name].call(this.webview, ...args);\n    };\n  }\n}\n\nconst webview = new WebviewProxy(adaWebview);\nwebview.initMethods(['exec', 'execWithTimeout', 'addNativeEventListener', 'removeNativeEventListener', 'checkApi']);\n\nexport {\n  webview as default,\n  isAndroid,\n  isIOS,\n  isInnerApp,\n  ajaxPostJSON,\n  ajaxPostFile,\n};\n","import 'core-js/stable';\nimport 'regenerator-runtime/runtime';\nimport 'intl'; // For Safari 9\nimport 'formdata-polyfill';\nimport 'fastestsmallesttextencoderdecoder';\n","import postFrog from '@services/frog.js';\n\nconst FROG_EVENTS = {\n  EVENT_ENTER_QUESTION: '/event/tutorYbc/QuestionBank/EnterQuestion', // 进入题目,\n  CLICK_BACK_BUTTON: '/click/tutorYbc/QuestionBank/QuestionQuitClick', // 点击返回按钮,\n  CLICK_EXIT: '/click/tutorYbc/QuestionBank/QuestionQuitSub', // 确定退出题目,\n  CLICK_CANCEL_EXIT: '/click/tutorYbc/QuestionBank/QuestionQuitCancel', // 取消退出题目,\n  CLICK_PASS_QUESTION: '/click/tutorYbc/QuestionBank/QuestionPassClick', // 点击返回按钮,\n  CLICK_FINISH: '/event/tutorYbc/QuestionBank/QuestionPassby', // 通过题目,\n};\n\nexport {\n  postFrog as default,\n  FROG_EVENTS,\n};\n","import xhr from '@services/xhr';\n\nconst environments = {\n  development: {\n    env: 'development',\n    baseUrl: 'http://ke.yuanfudao.biz',\n  },\n  test: {\n    env: 'test',\n    baseUrl: 'https://ke.yuanfudao.biz',\n  },\n  production: {\n    env: 'production',\n    baseUrl: 'https://steam.yuanfudao.com',\n  },\n};\nconst environment = environments[process.env.NODE_ENV];\nxhr.setOptions({\n  baseUrl: environment.baseUrl,\n});\nexport default xhr;\nexport {\n  environment,\n};\n","import xhr from './index.js';\n\nconst namespace = 'ada-steam-mission-gateway/api/user-mission-questions';\nconst {\n  userMissionId,\n  missionTemplateQuestionId,\n} = xhr.commonQueryParams;\nexport const fetchContent = () => {\n  return xhr.get(`/${namespace}`, {\n    params: {\n      userMissionId,\n      missionTemplateQuestionId,\n    },\n  });\n};\n\n\nexport function reportQuestionAnswerData(params) {\n  return xhr.post('/ada-event-tracking/api/neo-client/question', {\n    body: params\n  });\n}\n\nexport function answerQuestion(answer) {\n  return xhr.post('/ada-steam-mission-gateway/api/user-mission-questions/answer', {\n    body: answer\n  })\n}\n\n\n","import React, { Component } from 'react';\nimport bindAll from 'lodash.bindall';\nimport AppUtil from '@lib/app-util.js';\nimport postFrog, { FROG_EVENTS } from '../api/frog.js';\nimport xhr from '../api/index.js';\nimport minilog from '../../../services/logger';\n\nconst SOURCE_FROM_MATRIX = 'SOURCE_FROM_MATRIX';\n\nconst WebviewLifeHoc = (WrappedComponent) => {\n  class WebviewLifeWrapper extends Component {\n    constructor() {\n      super();\n      bindAll(this, [\n        'onNativeEvent',\n        'onIframeEvent',\n      ]);\n      this.state = {\n        matrix: null,\n      };\n      window.addEventListener('message', this.onIframeEvent);\n      minilog.info('questionLoaded href' + location.href);\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('message', this.onIframeEvent);\n    }\n\n    onIframeEvent(event) {\n      const type = event.data ? event.data.type : '';\n      if (type === SOURCE_FROM_MATRIX) {\n        this.setState({\n          matrix: {\n            data: event.data.content,\n          },\n        });\n      }\n    }\n\n    onNativeEvent({\n      questionStart,\n      questionResume,\n      questionPause,\n    }) {\n      if (questionStart) {\n        AppUtil.onStart(questionStart);\n      }\n      if (questionResume) {\n        AppUtil.onResume(questionResume);\n      }\n      if (questionPause) {\n        AppUtil.onPause(questionPause);\n      }\n    }\n\n    questionInited() {\n      minilog.info('questionInited');\n      setTimeout(() => {\n        AppUtil.emitReady();\n      }, 100);\n      AppUtil.onBeforeExit(() => {\n        postFrog(FROG_EVENTS.CLICK_CANCEL_EXIT)\n        return true;\n      }, 100);\n      postFrog(FROG_EVENTS.EVENT_ENTER_QUESTION);\n    }\n\n    questionComplete() {\n      if (xhr.commonQueryParams.sectionId) {\n        AppUtil.sendBehavior(xhr.commonQueryParams.sectionId)\n      }\n      postFrog(FROG_EVENTS.CLICK_FINISH);\n      AppUtil.emitComplete();\n    }\n\n    questionInitedFailed() {\n      AppUtil.emitError();\n    }\n\n    questionExit() {\n      AppUtil.emitExitRoom(xhr.commonQueryParams.sectionId);\n      postFrog(FROG_EVENTS.CLICK_BACK_BUTTON);\n    }\n\n    render() {\n      return (\n        <WrappedComponent\n          onNativeEvent={this.onNativeEvent}\n          questionInited={this.questionInited}\n          questionComplete={this.questionComplete}\n          questionInitedFailed={this.questionInitedFailed}\n          questionExit={this.questionExit}\n          matrix={this.state.matrix}\n          {...this.props} />\n      );\n    }\n  }\n  return WebviewLifeWrapper;\n};\n\nexport default WebviewLifeHoc;\n","import './public-path.js'; // 设置资源的cdn路径,必须放在最开头\nimport '../polyfill.js';\nimport '../../services/sentry';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport View from './view/view.jsx';\n// import xhr from './api/index';\nimport styles from './style.css';\n\nconst appTarget = document.createElement('div');\nappTarget.className = styles.app;\ndocument.body.appendChild(appTarget);\n\nReactDOM.render(\n  <View />,\n  appTarget,\n);\n","switch (process.env.NODE_ENV) {\ncase 'production':\n  __webpack_public_path__ = './';\n  break;\ncase 'test':\n  __webpack_public_path__ = './';\n  break;\ncase 'development':\n  __webpack_public_path__ = '';\n  break;\n}\nmodule.exports = __webpack_public_path__;\n","import React, { Component, createRef } from 'react';\nimport PropTypes, { resetWarningCache } from 'prop-types';\nimport classNames from 'classnames';\nimport bindAll from 'lodash.bindall';\nimport { fetchContent, reportQuestionAnswerData, answerQuestion } from '../api/question';\nimport WebviewLifeHoc from '../hoc/webview-life-hoc.jsx';\nimport postFrog, { FROG_EVENTS } from '../api/frog.js';\nimport { debounce, timeStr2Seconds, preloadVideo, checkQQBrowser } from '../../../lib/helper';\nimport styles from './style.css';\nimport GameRuntimeLoader from '@lib/game-runtime-loader';\nimport AppUtil from '@lib/app-util.js';\nimport xhr from '../api/index';\nimport toast from '@fenbi/ada-steam-components/toast';\nimport { isMobile, checkNotAllowVersion } from '../../../lib/helper';\nimport minilog from '../../../services/logger.js';\nimport { isIOS } from '@lib/webview.js';\nimport AppUtils from '@lib/app-util.js';\n// import json from './user-mission-questions-3290029.json';\\\nimport { BCIncentiveView, BCIncentiveViewOptions, PlatFormEnum, PageOptions } from \"@ada/ybc-interactive-incentive\";\n\n\n// 目前 Web 视频普遍 update time 周期在 150 - 320\nconst OFFSET = 0.05;\nclass View extends Component {\n  constructor(props) {\n    super(props);\n    bindAll(this, [\n      'handleLoaded',\n      'handleDoubt',\n      'handleQuestionEnd',\n      'handleAnswerEnd',\n      'handleNext',\n      'fetchData',\n      'initData',\n      'questionStart',\n      'questionPause',\n      'questionResume',\n      'setQuestionPlayer',\n      'setAnswerPlayer',\n      'backNormalVideo',\n      'toggleVideo',\n      'updateTime',\n      'onVideoPlay',\n      'playError',\n      'playEnd',\n      'playVideo'\n    ]);\n    this.gameContainer = document.querySelector('#game-container');\n    this.state = {\n      isPlayQuestion: false,\n      hasNext: false,\n      questionScratch: '',\n      answerScratch: '',\n      showBCLineBack: false,\n      videoUrl: '',\n      remoteVideoUrl: '',\n      caseStartTime: null,\n      caseTimeRange: {\n        start: 0,\n        end: 0\n      },\n      isPlaying: false,\n      showToggle: false,\n      gamePath: '',\n      safetyLeftArea: 0,\n      questionContent: null,\n    };\n    this.hasShowCase = false;\n    this.skipDuration = 30;\n    this.isGameOver = false;\n    this.nextTimer = null;\n    this.questionPlayer = null;\n    this.answerPlayer = null;\n    this.videoRef = createRef();\n    this.videoContainerRef = createRef();\n    this.incentiveViewRef = createRef();\n    this.fetchData();\n    props.onNativeEvent({\n      questionStart: this.questionStart,\n      questionPause: this.questionPause,\n      questionResume: this.questionResume,\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (!prevProps.matrix && this.props.matrix) {\n      this.initData(this.props.matrix.data);\n      // eslint-disable-next-line react/no-did-update-set-state\n      this.setState({\n        showMatrixBtn: true,\n      });\n    }\n  }\n\n  componentDidMount() {\n    this.setCanvas();\n    window.videoPlay = () => {\n      const { videoUrl } = this.state;\n      this.game && this.game.destroy(true);\n      if (this.isEnd || !videoUrl) {\n        this.submitAnswer();\n        this.setState({\n          showToggle: false,\n          isPlaying: false,\n        });\n      } else {\n        this.forceHideCase();\n        this.playVideo();\n        this.setState({\n          showToggle: true,\n          isPlaying: true,\n        });\n      }\n    }\n    this._showToggle = debounce(() => {\n      if (this.hasShowCase) {\n        return;\n      }\n      this.setState({\n        showToggle: !this.state.showToggle,\n      })\n    }, 300)\n    this.videoContainerRef && this.videoContainerRef.current.addEventListener('click', this._showToggle);\n    AppUtil.onBeforeSystemBack(() => {\n      this.videoRef.current && this.videoRef.current.pause();\n      this.setState({\n        isPlaying: false\n      });\n      const { hasShowCase } = this.state;\n      if (hasShowCase) {\n        GameRuntimeLoader.stopGameRunning();\n      }\n    });\n    AppUtil.onExitDialogCancel(() => {\n      GameRuntimeLoader.resumeGameRunning();\n      if (this.hasShowCase) {\n        return;\n      }\n      this.playVideo();\n      this.setState({\n        isPlaying: true\n      });\n    });\n\n    AppUtil.getSafeArea((area) => {\n      if (area && area.left > 0) {\n        this.setState({\n          safetyLeftArea: area.left\n        })\n      }\n    })\n\n    const handler = () => {\n      if (this.game) {\n        minilog.info('visibilitychange', document.visibilityState);\n        if (document.visibilityState === 'visible') {\n          GameRuntimeLoader.resumeGameRunning();\n        } else {\n          GameRuntimeLoader.stopGameRunning();\n        }\n      }\n    }\n    window.addEventListener(\"resize\", this.setCanvas);\n    document.addEventListener(\"visibilitychange\", handler);\n    document.addEventListener(\"focusout\", this.focusoutHandler);\n  }\n\n  focusoutHandler() {\n    // fix ios 12键盘收起后 页面不复原\n    if (isIOS) {\n      window.scrollTo({ top: 0, left: 0, behavior: 'smooth' });\n    }\n  }\n\n  questionStart() {\n    minilog.info('questionStart');\n    if (!AppUtil.isSafeAppVersion()) {\n      toast.warning('当前 APP 版本过低请升级', 1500, false);\n      return;\n    }\n    if (navigator.userAgent.match(/iP(hone|od|ad)/)) {\n      AppUtil.isMute((result) => {\n        minilog.info('isMute', result);\n        if (result) {\n          toast.warning('该设备处于静音状态，请关闭静音哦', 1500, false);\n        }\n      });\n    }\n    GameRuntimeLoader.startGameRunning();\n    if (this.hasShowCase) {\n      this.setState({\n        showToggle: false\n      });\n      return;\n    }\n    this.playVideo();\n  }\n\n  questionPause() {\n    this.questionPlayer && this.questionPlayer.pause();\n    this.answerPlayer && this.answerPlayer.pause();\n  }\n\n  questionResume() {\n    this.questionPlayer && this.questionPlayer.resume();\n    this.answerPlayer && this.answerPlayer.resume();\n  }\n\n  setQuestionPlayer(player) {\n    this.questionPlayer = player;\n  }\n\n  setAnswerPlayer(player) {\n    this.answerPlayer = player;\n  }\n\n  fetchData() {\n    let promise;\n    promise = fetchContent();\n    promise\n      .then((data) => {\n        this.initData(data);\n      })\n      .catch((err) => {\n        this.props.questionInitedFailed();\n        minilog.info(\"fetch api error\", err);\n      });\n  }\n\n  initData(data = {}) {\n    let questionContent = {};\n    if (typeof data === 'string') {\n      data = JSON.parse(data);\n    }\n    let caseStartTime, videoUrl, gamePath;\n    this.reportProviderData = data\n    GameRuntimeLoader.lastCaseState = data.latestAnswer;\n    if (data.questionContent) {\n      this.questionStartTime = new Date().getTime();\n      let temp = data.questionContent;\n      if (typeof temp === 'string') {\n        try {\n          temp = JSON.parse(temp);\n          questionContent = temp;\n          this.setState({ questionContent });\n          console.log(\"questionContent\", questionContent)\n          caseStartTime = timeStr2Seconds(questionContent.videoCase.caseArr[0].startTime);\n          videoUrl = questionContent.videoCase.mainVideo;\n          gamePath = questionContent.videoCase.caseArr[0].fileName.replace('.zip', '');\n          const gameCDNUrl = questionContent.videoCase.caseArr[0].url;\n          let localFileName = gameCDNUrl && gameCDNUrl.split('/').pop();\n          if (localFileName) {\n            localFileName = localFileName.replace('.zip', '');\n            console.log(\"localFileName\", localFileName)\n            AppUtil.getLocalResource('').then((localFilePath) => {\n              console.log(\"localFilePath\", localFilePath)\n              if (localFilePath) {\n                gamePath = localFilePath + localFileName + '/' + gamePath\n                this.setState({\n                  gamePath,\n                });\n              }\n              if (!gamePath && !videoUrl) {\n                minilog.info('can not find game path');\n                throw new Error('can not find game path');\n              }\n              if (videoUrl) {\n                this.handleVideo(videoUrl)\n              } else {\n                this.trySendReadyEvent();\n              }\n\n            }).catch(err => {\n              console.error('parse data error' + err);\n              if (videoUrl) {\n                this.handleVideo(videoUrl);\n              } else {\n                // 对于不支持本地文件获取的默认放行\n                this.props.questionInited();\n              }\n              minilog.error('getLocalResource error', err);\n            });\n          }\n        } catch (err) {\n          minilog.error('questionInitedFailed error', err);\n          this.props.questionInitedFailed();\n        }\n      }\n    }\n\n    this.setState({\n      showBCLineBack: !data.stageY,\n      caseStartTime,\n      caseTimeRange: {\n        start: caseStartTime,\n        end: caseStartTime + OFFSET,\n      },\n      caseFinished: false,\n      gamePath,\n    });\n    if (!window.userId) {\n      // 启蒙带上userId\n      Sentry && Sentry.setTag(\"userId\", data.userId);\n    }\n  }\n\n  handleVideo(videoUrl) {\n    let useBlob = true\n    if (navigator.userAgent.match(/iP(hone|od|ad)/)) {\n      const iphone_version = parseFloat(String(navigator.userAgent.match(/[0-9]+_[0-9]/)).split('_')[0] + '.' + String(navigator.userAgent.match(/[0-9]_[0-9]/)).split('_')[0]);\n      if (iphone_version <= 10) {\n        useBlob = false;\n      }\n    }\n    if (checkQQBrowser()) {\n      useBlob = false;\n    }\n    minilog.info(\"useBlob\" + useBlob)\n    if (useBlob) {\n      preloadVideo(videoUrl, (localUrl) => {\n        this.setState({\n          videoUrl: localUrl\n        });\n        this.trySendReadyEvent();\n      }, (err) => {\n        this.setState({\n          videoUrl,\n          remoteVideoUrl: videoUrl,\n        });\n        this.bindVideoLoadEvent();\n      });\n    } else {\n      this.setState({\n        videoUrl,\n        remoteVideoUrl: videoUrl,\n      });\n      this.bindVideoLoadEvent();\n    }\n  }\n\n  setCanvas() {\n    minilog.info('setCanvas', window.innerHeight, window.innerWidth);\n    const scale = window.innerHeight / window.innerWidth;\n    const container = document.getElementById(\"game-container\");\n    if (scale > (9 / 16)) {\n      const height = window.innerWidth / 16 * 9;\n      container.style.width = '100%';\n      container.style.height = height + 'px';\n      container.style['margin-top'] = '-' + height / 2 + 'px';\n      container.style.top = '50%';\n      container.style.left = 0;\n      container.style['margin-left'] = 0;\n    } else {\n      const width = window.innerHeight / 9 * 16;\n      container.style.width = width + 'px';\n      container.style.height = '100%';\n      container.style['margin-left'] = '-' + width / 2 + 'px';\n      container.style.left = '50%';\n      container.style.top = 0;\n      container.style['margin-top'] = 0;\n    }\n    minilog.info(\"container style\", container.style.width, container.style.height)\n  }\n\n  trySendReadyEvent(isVideoLoaded) {\n    const { videoUrl, gamePath, remoteVideoUrl, caseStartTime } = this.state\n    minilog.info(\"remoteVideoUrl\" + remoteVideoUrl)\n    minilog.info(\"videoUrl\" + videoUrl)\n    minilog.info(\"gamePath\" + gamePath)\n    let isNeedHideCase = caseStartTime >= OFFSET;\n    minilog.info(\"isNeedHideCase\" + isNeedHideCase)\n    if (!isNeedHideCase) {\n      this.showCase();\n    }\n    this.hasShowCase = !isNeedHideCase;\n\n    if (remoteVideoUrl) {\n      if (isVideoLoaded && this.game) {\n        isNeedHideCase && this.hideCase();\n        this.props.questionInited();\n        return;\n      }\n    } else {\n      if (gamePath && videoUrl) {\n        isNeedHideCase && this.hideCase();\n        this.props.questionInited();\n        return;\n      }\n      if (gamePath) {\n        this.props.questionInited();\n      }\n    }\n\n    // 如果不存在游戏，使用视频进行播放即可\n    if (!gamePath && videoUrl) {\n      this.props.questionInited();\n    }\n\n  }\n\n  handleLoaded() {\n    this.props.questionInited();\n  }\n\n  handleDoubt() {\n    if (this.isGameOver) return;\n    this.setState({\n      isPlayQuestion: true,\n      showExtraBtn: false,\n    });\n    postFrog(FROG_EVENTS.CLICK_PLAY_QUESTION);\n  }\n\n  handleQuestionEnd() {\n    this.setState({\n      isPlayQuestion: false,\n      showExtraBtn: true,\n    });\n    if (!this.nextTimer) {\n      this.nextTimer = setTimeout(() => {\n        this.setState({\n          hasNext: true,\n        });\n      }, this.skipDuration * 1000);\n    }\n  }\n  // 不阻塞答题流程\n  submitAnswer() {\n    minilog.info(\"submitAnswer\");\n    answerQuestion({\n      userQuestionId: this.reportProviderData.id,\n      userQuestionAnswerRoundId: this.reportProviderData.userQuestionAnswerRoundId,\n      status: 1, // 不存在错误情况\n      timeElapsed: new Date().getTime() - this.questionStartTime,\n      answer: GameRuntimeLoader.submitCaseState || '',\n      userSectionId: xhr.commonQueryParams.sectionId,\n    }).then(async (res) => {\n      minilog.info(\"submitAnswer success\", res);\n      await this.showIncentiveView(res);\n      this.reportQuestionAnswerData({ answerId: res.id, });\n    }).catch(err => {\n      minilog.info(\"submitAnswer fail\", err);\n      this.props.questionComplete();\n    });\n  }\n\n  // 激励样式\n  showIncentiveView(res) {\n    const { hasCoin, incentiveType } = this.state.questionContent || {};\n    const { score } = res;\n    minilog.info(\"showIncentiveView\", hasCoin, score);\n    if (!hasCoin) return Promise.resolve();\n    return new Promise((resolve) => {\n      const options = {\n        container: this.incentiveViewRef.current,\n        onClose: () => {\n          resolve();\n        },\n      };\n      if (incentiveType === 'block') {\n        options.stars = 3;\n        options.type = 'block';\n      } else {\n        options.result = true;\n        options.type = 'code';\n      }\n      if (score) {\n        options.coin = score;\n      }\n      BCIncentiveView(options);\n    });\n  }\n\n\n\n  reportQuestionAnswerData(injectValue) {\n    // 3.0 才上报\n    if (!AppUtil.isYBCApp()) return;\n    try {\n      const queryObj = xhr.commonQueryParams;\n      const { ybcEpisodeId, ybcLessonId, sectionId, missionType, userMissionId } = queryObj;\n      const { answerId } = injectValue;\n      const bizId = Number(ybcEpisodeId || 0);\n      const bizType = 1;\n      const userId = this.reportProviderData.userId;\n      const startTime = this.questionStartTime;\n      const endTime = new Date().getTime();\n      const runNumber = 0;\n      const codeLines = 0;\n      const userQuestionId = this.reportProviderData.id;\n      const answerCode = '';\n      const questionScene = 203; // 猿编程录播\n      const questionId = this.reportProviderData.questionId;\n      const questionOrdinal = -1;\n      const questionInfo = {\n        startTime,\n        endTime,\n        answerId,\n        questionResult: 3,\n        runNumber,\n        codeLines,\n        userQuestionId,\n        answerCode,\n        questionScene,\n        questionType: 306,\n        questionId,\n        questionOrdinal,\n        errorRunNumber: 0,\n        sectionId: Number(sectionId)\n      };\n      const dataContent = {\n        bizId,\n        bizType,\n        ybcLessonId: Number(ybcLessonId),\n        userId,\n        questionInfo,\n        missionType,\n        userMissionId\n      };\n      AppUtil.getAppInstance().getAppConfig().then((res) => {\n        const { productId } = res;\n        dataContent.productId = productId;\n        setTimeout(() => {\n          this.props.questionComplete();\n        }, 120);\n        reportQuestionAnswerData(dataContent);\n      }).catch((error) => {\n        minilog.info('[reportQuestionAnswerData] error', dataContent, error);\n        this.props.questionComplete();\n      });\n    } catch (error) {\n      minilog.info('[reportQuestionAnswerData] error', error);\n      this.props.questionComplete();\n    }\n  }\n\n  showCase() {\n    if (this.hasShowCase) {\n      return;\n    }\n    this.pauseVideo();\n    this.gameContainer.style.display = '';\n    this.hasShowCase = true;\n    minilog.info(\"showCase\" + this.hasShowCase)\n    this.initGame();\n    this.setState({\n      showToggle: false,\n      isPlaying: false,\n      caseFinished: true,\n    });\n  }\n\n\n  hideCase() {\n    if (this.hasShowCase) {\n      return;\n    }\n    this.hasShowCase = false;\n    this.gameContainer.style.display = 'none';\n  }\n\n  initGame() {\n    const { gamePath } = this.state;\n    if (gamePath) {\n      GameRuntimeLoader.init(gamePath, (game) => {\n        this.game = game;\n        minilog.info(\"initGame\")\n      }, (error) => {\n        minilog.info(\"initGame error\", error);\n        this.props.questionInitedFailed();\n      });\n    }\n  }\n\n  forceHideCase() {\n    this.hasShowCase = false;\n    this.gameContainer.style.display = 'none';\n    this.setState({\n      caseStartTime: -1,\n    });\n  }\n\n  toggleVideo() {\n    const { isPlaying } = this.state;\n    if (isPlaying) {\n      this.pauseVideo();\n    } else {\n      this.playVideo();\n    }\n    this.setState({\n      isPlaying: !isPlaying\n    })\n  }\n\n  startTimeWatch() {\n    this.stopTimeWatch();\n    this._timeTask = setInterval(() => {\n      if (this.isEnd) {\n        this.stopTimeWatch();\n        return;\n      }\n      this.updateTime()\n    }, 50);\n  }\n\n  stopTimeWatch() {\n    window.clearInterval(this._timeTask);\n  }\n\n  onVideoPlay() {\n    this.setState({\n      isPlaying: true\n    });\n  }\n\n  playEnd() {\n    const { caseStartTime, caseFinished } = this.state;\n    this.isEnd = true;\n    if (typeof caseStartTime != 'number') {\n      this.showCase();\n      return;\n    }\n    const duration = parseInt(this.videoRef.current.duration);\n    if (!caseFinished) {\n      this.showCase();\n      return;\n    }\n    this.stopTimeWatch();\n    this.submitAnswer();\n    this.setState({\n      isPlaying: false,\n      showToggle: true,\n      caseFinished: false,\n    })\n  }\n\n  playError() {\n    const { videoUrl } = this.setState;\n    if (!videoUrl) {\n      return;\n    }\n    const error = this.videoRef.current.error\n    minilog.info(\"playError\", error);\n    this.props.questionInitedFailed();\n  }\n\n  updateTime() {\n    const { videoUrl, caseTimeRange, caseFinished } = this.state;\n    if (!videoUrl) {\n      return;\n    }\n    const currentTime = this.videoRef.current.currentTime;\n    const duration = this.videoRef.current.duration;\n    // console.log(\"currentTime\", currentTime)\n    // console.log(\"caseTimeRange\", caseTimeRange)\n    // console.log(\"caseTimeRange\", duration)\n    if (currentTime >= duration) {\n      this.stopTimeWatch();\n    }\n    if (!caseFinished && (currentTime >= caseTimeRange.start && currentTime < caseTimeRange.end)) {\n      this.showCase();\n    }\n  }\n\n  // 如果全量加载视频异常，使用 CDN 地址，需要监听 MetaData\n  bindVideoLoadEvent() {\n    this.videoRef.current.addEventListener('loadedmetadata', () => {\n      this.trySendReadyEvent(true);\n    })\n  }\n\n  handleAnswerEnd() {\n    this.isGameOver = true;\n    clearTimeout(this.nextTimer);\n    postFrog(FROG_EVENTS.CLICK_FINISH)\n    this.submitAnswer();\n  }\n\n  backNormalVideo() {\n    this.videoRef.current && this.videoRef.current.pause();\n    this.props.questionExit();\n    this.setState({\n      isPlaying: false\n    });\n    const { hasShowCase } = this.state;\n    if (hasShowCase) {\n      GameRuntimeLoader.stopGameRunning();\n    }\n  }\n\n  handleNext() {\n    postFrog(FROG_EVENTS.CLICK_SKIP_GAME);\n  }\n\n  playVideo() {\n    this.videoRef.current && this.videoRef.current.play();\n    this.startTimeWatch();\n  }\n\n  pauseVideo() {\n    this.videoRef.current && this.videoRef.current.pause();\n    this.stopTimeWatch();\n  }\n\n\n  render() {\n    const {\n      videoUrl,\n      isPlaying,\n      showToggle,\n      safetyLeftArea\n    } = this.state\n    const playCls = classNames(styles.btnControl, isPlaying ? styles.pause : styles.play);\n    return (\n      <div>\n        <div\n          className={classNames(styles.backCircleBtn, { [styles.aiBackCircleBtn]: AppUtils.isAIApp() })}\n          style={{\n            marginLeft: safetyLeftArea\n          }}\n          onClick={this.backNormalVideo}\n        />\n        <div className={styles.incentiveContainer} ref={this.incentiveViewRef}></div>\n        <div className={styles.videoContainer} ref={this.videoContainerRef}>\n          {videoUrl && (\n            <video\n              ref={this.videoRef}\n              className={styles.video}\n              onPlay={this.onVideoPlay}\n              onEnded={this.playEnd}\n              onError={this.playError}\n              playsInline\n              preload=\"auto\"\n              src={videoUrl}\n              x5-video-player-type=\"h5\"\n              webkitplaysinline=\"true\"\n            ></video>\n          )}\n\n          {showToggle && (\n            <div\n              className={playCls}\n              style={{\n                marginLeft: safetyLeftArea\n              }}\n              onClick={this.toggleVideo}\n            />\n          )}\n\n        </div>\n\n      </div>\n    );\n  }\n}\n\nView.propTypes = {\n  onNativeEvent: PropTypes.func,\n  questionInitedFailed: PropTypes.func,\n  questionComplete: PropTypes.func,\n  questionInited: PropTypes.func,\n  questionExit: PropTypes.func,\n};\n\nexport default WebviewLifeHoc(View);\n","import webview, { isInnerApp } from '@lib/webview.js';\nimport AppUtil from '@lib/app-util.js';\nimport xhr from './xhr.js';\n// 可发送日志的域名列表\nconst whiteList = [\n  'ke.yuanfudao.biz',\n  'steam.yuanfudao.com',\n];\n\nconst AnswerSceneFrog = {\n  RECORD: '录播',\n  ENLIGHTENMENT: '思维启蒙',\n}\nconst MissionTypeEnum = {\n  RECORD: '1', // 普通录播\n  ENLIGHTENMENT: '12', // 思维启蒙\n}\n\nconst ajaxPostFrog = function (url, params) {\n  if (isInnerApp) {\n    webview.exec('ajaxPostFrog', {\n      url,\n      params,\n    });\n  } else if (AppUtil.isYBCApp()) {\n    const app = xhr.parseWebAppInfo();\n    const commonParams = {\n      ybcEpisodeId: xhr.commonQueryParams.ybcEpisodeId,\n      episodeType: xhr.commonQueryParams.episodeType,\n      sectionId: xhr.commonQueryParams.sectionId,\n      questionMissionUserID: xhr.commonQueryParams.userMissionId,\n      questionTypes: app.appId,\n      questionWebAppidVersion: app.appVersion,\n      questionType: '251',\n      lessonId: xhr.commonQueryParams.ybcLessonId,\n      answerScene:\n        xhr.commonQueryParams.missionType === MissionTypeEnum.ENLIGHTENMENT\n          ? AnswerSceneFrog.ENLIGHTENMENT\n          : AnswerSceneFrog.RECORD,\n    }\n    AppUtil.sendFrog(url, Object.assign(commonParams, params));\n  }\n};\nexport default function postFrog(frogUrlType, args) {\n  if (!frogUrlType) return;\n  // 参数中的数字变为字符串\n  if (Object.prototype.toString.call(args) === '[object Object]') {\n    for (const key in args) {\n      args[key] = `${args[key]}`;\n    }\n  }\n  if (whiteList.find((item) => location.host === item) !== undefined) {\n    return ajaxPostFrog(frogUrlType, args);\n    // 录播课为本地文件\n  } else if (AppUtil.isYBCApp()) {\n    return ajaxPostFrog(frogUrlType, args);\n  }\n}\n","import minilog from 'minilog';\nimport { EventEmitter } from 'events';\nimport webview, { isInnerApp } from '@lib/webview.js';\nimport AppUtil from '../lib/app-util';\n\n/**\n * 日志记录\n * @param {string} abstract 日志信息摘要,\n * 需要在信息前配上一个分类，目前有（[CLICK]，[PROC]，[XHR]）,可以根据实际场景细化。\n * @param {any} details 日志内容的具体细节信息（通常在 error 中使用）,其中detail和detail之间通过 ｜ 分隔\n * 如 [CLICK] green flag 用户点击绿旗行为\n *    [PROC] start to save question content 开始保存用户的 scratch 项目\n * logger.info(abstract,detail1, detail2, ....)\n * logger.error(abstract,detail)\n */\nclass AliyunLog extends EventEmitter {\n  constructor() {\n    super();\n    this.defaultAbstract = 'LOG';\n    this.postfix = `href: ${location.href}`;\n    this.divide = '|';\n  }\n\n  write(app, level, logs) {\n    const args = [...logs];\n    const abstract = args.shift() || this.defaultAbstract;\n\n    // console.log(`上报阿里云日志：[${app}] [${level}] [${abstract}]${this.parseArgs(args)}`);\n    if (['info', 'error', 'warn'].includes(level)) {\n      const detail = this.parseArgs(args);\n      if (isInnerApp) {\n        webview.exec('aliyunLog', {\n          logString: `[${app}] [${level}] [${abstract}] ${detail}`,\n        }).catch((err) => {\n          // 忽略超时\n          if (/TIMEOUT/i.test(err)) return;\n        });\n      } else if (AppUtil.isYBCApp()) {\n        try {\n          AppUtil.sendDebugLog(`[${app}] [${level}] [${abstract}] ${detail}`);\n        } catch (err) {\n          console.error(err)\n        }\n      }\n    }\n  }\n\n  parseArgs(args) {\n    args.push(this.postfix);\n    return args.reduce((acc, cur) => {\n      try {\n        let str = cur;\n        switch (typeof cur) {\n          case 'object':\n            if (cur instanceof Error) {\n              str = JSON.stringify(cur, Object.getOwnPropertyNames(cur));\n              if (cur.toString instanceof Function) {\n                str += cur.toString();\n              }\n              if (cur.valueOf instanceof Function) {\n                str += cur.valueOf();\n              }\n              if (cur.error) {\n                str += cur.error.stack;\n              }\n              var typeName = cur.target && cur.target.localName; // 资源404的类型\n              if (typeName === \"link\") {\n                str += \"link=\" + cur.target.href;\n              } else if (typeName === \"script\") {\n                str += \"script=\" + cur.target.src;\n              }\n            } else {\n              str = JSON.stringify(cur);\n            }\n            break;\n          case 'function':\n            str = `(Function ${cur.name})`;\n            break;\n          default:\n            break;\n        }\n        return `${acc} ${this.divide} ${str}`;\n      } catch (e) {\n        console.warn('parseArgs err', cur);\n        return acc;\n      }\n    }, '');\n  }\n}\n// minilog.enable();\nminilog.pipe(new AliyunLog());\n\nwindow.$minilog = minilog('ada-video-interactive');\nexport default window.$minilog;\nexport {\n  minilog,\n};\n","import { Integrations } from '@sentry/tracing';\nimport { CaptureConsole } from '@sentry/integrations';\nimport { user } from '@ybc/client-api';\nimport * as Sentry from \"@sentry/browser\";\nimport xhr from './xhr.js';\n\nfunction sentryInit() {\n  const env = process.env.NODE_ENV;\n  const config = {\n    dsn: 'https://f405e550631747d5b7b548129eb8d048@sentry-fe.yuanfudao.com/387',\n    integrations: [\n      new Integrations.BrowserTracing(),\n      new CaptureConsole({\n        levels: ['error']\n      }),\n    ],\n    tracesSampleRate: 1,\n    environment: env,\n    release: window.__sentryRelease__,\n  };\n  if (['production', 'test'].includes(env)) {\n    Sentry.init(config);\n  }\n\n  // sentry tag 增加sectionId\n  if (xhr.commonQueryParams?.sectionId) {\n    Sentry.setTag(\"sectionId\", xhr.commonQueryParams.sectionId);\n  }\n\n  if (user) {\n    // sentry tag 增加userId\n    user.getUserId().then((userId) => {\n      if (userId) {\n        window.userId = userId;\n        Sentry.setTag(\"userId\", userId);\n      }\n    }).catch(error => {\n      console.error(error);\n    })\n  }\n\n  // proxy window to pass new data\n  if (!window.Sentry) {\n    window.Sentry = Sentry;\n  }\n}\nsentryInit();\n\nexport default Sentry;\n\n","import queryString from 'query-string';\nimport { v4 as uuidv4, v1 as uuidv1 } from 'uuid';\nimport xhr from 'xhr';\n// import { StageStore } from '@/store/stageStore';\nimport { network } from '@ybc/client-api';\nimport {\n  isInnerApp,\n  ajaxPostJSON,\n  ajaxPostFile,\n  isIOS,\n} from '@lib/webview.js';\nimport AppUtil from '@lib/app-util';\nimport logger from './logger';\n\nconst commonQueryParams = {\n  _productId: 1222, // 客户端唯一标志\n  _hostProductId: 1222, // ?\n  version: '0.1.0',\n  UDID: uuidv4(), // 设备唯一标示\n  ...queryString.parse(window.location.search),\n};\n\nconst defaultOptions = {\n  method: 'get',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  timeout: 10000,\n  withCredentials: true,\n  withCommonQuery: true,\n  baseUrl: '',\n};\nconst xhrOptions = JSON.parse(JSON.stringify(defaultOptions));\n\nconst setOptions = (options) => {\n  if (!options || typeof options !== 'object') return;\n  Object.keys(options).forEach((key) => {\n    const opt = options[key];\n    if (key === 'headers') {\n      xhrOptions.headers = {\n        ...defaultOptions.headers, ...opt };\n    } else if (typeof opt !== 'undefined') {\n      xhrOptions[key] = opt;\n    }\n  });\n};\nconst iosJsonAjax = (opts, callback) => {\n  const {\n    url,\n    method,\n    headers,\n    body,\n    timeout,\n  } = opts;\n  const timer = setTimeout(() => {\n    callback('iosJsonAjax timeout');\n  }, timeout);\n  ajaxPostJSON(url, method, headers, body, timeout).then((result) => {\n    const [code, body] = result;\n    callback(null, {\n      statusCode: code,\n      body,\n    });\n  }).catch((err) => {\n    callback(err);\n    clearTimeout(timer);\n  }).then(() => {\n    clearTimeout(timer);\n  });\n};\n\nconst ybcAjax = (opts, callback) => {\n  const {\n    url,\n    method,\n    body,\n    timeout,\n  } = opts;\n  const timer = setTimeout(() => {\n    callback('ybcAjax timeout');\n  }, timeout);\n  let promise;\n  if (method === 'POST') {\n    promise = network.requestByClient.post(url, body, opts)\n  } else {\n     promise = network.requestByClient.get(url, opts)\n  }\n  return promise.then((result) => {\n    callback(null, {\n      statusCode: result.status,\n      body: result.data,\n    })\n    clearTimeout(timer);\n  }).catch(err => {\n    clearTimeout(timer);\n    callback(err)\n  }) \n}\n\nconst toBase64 = (file) => new Promise((resolve, reject) => {\n  const reader = new FileReader();\n  reader.readAsDataURL(file);\n  reader.onload = () => resolve(reader.result);\n  reader.onerror = (error) => reject(error);\n});\nconst iosFileAjax = (opts, callback) => {\n  const { href_, search_, headers, body: formData, timeout } = opts;\n  const timer = setTimeout(() => {\n    callback('iosFileAjax timeout');\n  }, timeout);\n  Promise.all([...formData.keys()].map((key) => {\n    const file = formData.get(key);\n    return toBase64(file).then((base64) => ({\n      [key]: base64.split(',')[1],\n      fileName: file.name,\n    }));\n  })).then((arr) => {\n    const body = arr.reduce((pre, cur) => Object.assign(pre, cur), {});\n    const url = `${href_}/base64?${search_}`;\n    ajaxPostFile(url, headers, body, timeout).then((result) => {\n      const [code, body] = result;\n      callback(null, {\n        statusCode: code,\n        body,\n      });\n    }).catch((err) => {\n      callback(err);\n    }).then(() => {\n      clearTimeout(timer);\n    });\n  });\n};\n\nfunction  parseWebAppInfo() {\n  const path = location.pathname;\n  const reg = /\\.([0-9]+)\\.([0-9]{1,4})/;\n  const result = path.match(reg);\n  const appId = result[1] || \"\"\n  const appVersion = result[2] || \"\"\n  return {\n    appId,\n    appVersion\n  }\n}\n\n\nconst request = (url, options) => {\n  const opts = { ...xhrOptions, ...options };\n  const qs = queryString.stringify({ ...(opts.withCommonQuery ? commonQueryParams : {}), ...options.params });\n  opts.href_ = url;\n  if (!/^http/.test(url)) {\n    url = `${opts.baseUrl}${url}`;\n  }\n  opts.url = `${url}?${qs}`;\n  opts.search_ = qs;\n  opts.method = opts.method.toUpperCase();\n  if (opts.headers && opts.headers['Content-Type'] === 'application/json' && typeof opts.body === 'object' && !AppUtil.isYBCApp()) {\n    opts.body = JSON.stringify(opts.body);\n  }\n  let ajax = xhr;\n  // ios客户端内的post请求需要携带body的，要走jsBridge\n  if (isInnerApp && isIOS && ['POST', 'PUT', 'DELETE'].includes(opts.method) && options.body) {\n    if (opts.headers && opts.headers['Content-Type'] === 'application/json') {\n      ajax = iosJsonAjax;\n    } else {\n      ajax = iosFileAjax;\n    }\n  } else if (AppUtil.isYBCApp()) {\n    ajax = ybcAjax;\n  }\n  const requestId = uuidv1();\n  const logarr = ['XHR', opts.method, `requestId: ${requestId}`, opts.href_];\n  return new Promise((resolve, reject) => {\n    const startTime = Date.now();\n    // logger.info(...logarr, `request-start: ${opts.search_}`);\n    ajax(opts, (err, res) => {\n      const duration = Date.now() - startTime;\n      if (err) {\n        logger.error(...logarr, `request-error: ${err}`, `duration: ${duration}ms`);\n        return reject(err);\n      }\n      let body = res.body;\n      if (res.statusCode !== 200) {\n        logger.error(...logarr, `request-error: response status is ${res.statusCode}`, `duration: ${duration}ms`);\n        return reject(res);\n      }\n      if (typeof body !== 'object') {\n        try {\n          body = JSON.parse(body);\n        } catch (e) {\n          console.warn('parse body error', e);\n        }\n      }\n      // logger.info(...logarr, 'request-success', `duration: ${duration}ms`);\n      return resolve(body);\n    });\n  });\n};\n\nconst requestWithMethod = (method) => (url, options) => request(url, { ...options, method });\n\nexport default {\n  setOptions,\n  request,\n  post: requestWithMethod('post'),\n  get: requestWithMethod('get'),\n  delete: requestWithMethod('delete'),\n  put: requestWithMethod('put'),\n  parseWebAppInfo,\n  commonQueryParams,\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"app\":\"style_app_3RXP5\"};","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"style_container_2QI1j\",\"backCircleBtn\":\"style_backCircleBtn_3WBDR\",\"aiBackCircleBtn\":\"style_aiBackCircleBtn_3EsTF\",\"incentiveContainer\":\"style_incentiveContainer_IHm9X\",\"video-container\":\"style_video-container_1x59Q\",\"videoContainer\":\"style_video-container_1x59Q\",\"video\":\"style_video_2aAPN\",\"btn-control\":\"style_btn-control_3G9pk\",\"btnControl\":\"style_btn-control_3G9pk\",\"play\":\"style_play_14uK5\",\"pause\":\"style_pause_v1y_R\"};"],"sourceRoot":""}